



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://blog.52szu.tech/szu_courses/csapp/bomblab/">
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="ja">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.1">
    
    
      
        <title>Bomb Lab - Keep Evolving</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.3020aac5.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#main" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://blog.52szu.tech" title="Keep Evolving" class="md-header-nav__button md-logo">
          
            <i class="md-icon">flight_takeoff</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Keep Evolving
            </span>
            <span class="md-header-nav__topic">
              Bomb Lab
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/szu17dmy/szu17dmy.github.io/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    szu17dmy.github.io
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://blog.52szu.tech" title="Keep Evolving" class="md-nav__button md-logo">
      
        <i class="md-icon">flight_takeoff</i>
      
    </a>
    Keep Evolving
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/szu17dmy/szu17dmy.github.io/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    szu17dmy.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      HOMEPAGE
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        HOMEPAGE
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../.." title="HOME" class="md-nav__link">
      HOME
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../about/" title="ABOUT" class="md-nav__link">
      ABOUT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../links/" title="LINKS" class="md-nav__link">
      LINKS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      CTF TOOLS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        CTF TOOLS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_tools/pwntools/" title="Windows下利用WSL使用pwntools" class="md-nav__link">
      Windows下利用WSL使用pwntools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_tools/base64/" title="在线BASE64加解密（实验性）" class="md-nav__link">
      在线BASE64加解密（实验性）
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      CTF WRITEUP
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        CTF WRITEUP
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      CISCN 2019
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        CISCN 2019
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-1" type="checkbox" id="nav-3-1-1">
    
    <label class="md-nav__link" for="nav-3-1-1">
      MISC
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-1">
        MISC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/ciscn2019/qiandao/" title="签到" class="md-nav__link">
      签到
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/ciscn2019/saleae/" title="saleae" class="md-nav__link">
      saleae
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/ciscn2019/24c/" title="24c" class="md-nav__link">
      24c
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      BugKu
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        BugKu
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-1" type="checkbox" id="nav-3-2-1">
    
    <label class="md-nav__link" for="nav-3-2-1">
      MISC
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-2-1">
        MISC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/misc_50/" title="MISC 50" class="md-nav__link">
      MISC 50
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/misc_60/" title="MISC 60" class="md-nav__link">
      MISC 60
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/misc_80/" title="MISC 80" class="md-nav__link">
      MISC 80
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/想蹭网先解开密码/" title="想蹭网先解开密码" class="md-nav__link">
      想蹭网先解开密码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/Linux2/" title="Linux2" class="md-nav__link">
      Linux2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/细心的大象/" title="细心的大象" class="md-nav__link">
      细心的大象
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/普通的二维码/" title="普通的二维码" class="md-nav__link">
      普通的二维码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/乌云邀请码/" title="乌云邀请码" class="md-nav__link">
      乌云邀请码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/图穷匕见/" title="图穷匕见" class="md-nav__link">
      图穷匕见
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/convert/" title="convert" class="md-nav__link">
      convert
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/听首音乐/" title="听首音乐" class="md-nav__link">
      听首音乐
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/bugku/好多数值/" title="好多数值" class="md-nav__link">
      好多数值
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Pragyan CTF 19
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Pragyan CTF 19
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3-1" type="checkbox" id="nav-3-3-1">
    
    <label class="md-nav__link" for="nav-3-3-1">
      Forensics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-1">
        Forensics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/pctf2019/welcome/" title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/pctf2019/magic_pngs/" title="Magic PNGs" class="md-nav__link">
      Magic PNGs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/pctf2019/save_earth/" title="Save Earth" class="md-nav__link">
      Save Earth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/pctf2019/slow_realization/" title="Slow Realization" class="md-nav__link">
      Slow Realization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/pctf2019/late_pr/" title="Late PR" class="md-nav__link">
      Late PR
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3-2" type="checkbox" id="nav-3-3-2">
    
    <label class="md-nav__link" for="nav-3-3-2">
      Miscellaneous
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-2">
        Miscellaneous
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/pctf2019/exorcism/" title="EXORcism" class="md-nav__link">
      EXORcism
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3-3" type="checkbox" id="nav-3-3-3">
    
    <label class="md-nav__link" for="nav-3-3-3">
      Web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-3">
        Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/pctf2019/cookie_monster/" title="Cookie Monster" class="md-nav__link">
      Cookie Monster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/pctf2019/game_of_faces/" title="Game of Faces" class="md-nav__link">
      Game of Faces
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Hackergame 2018
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Hackergame 2018
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/hackergame2018/hello_world/" title="签到题" class="md-nav__link">
      签到题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/hackergame2018/ustc_quiz/" title="猫咪问答" class="md-nav__link">
      猫咪问答
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/hackergame2018/card/" title="游园会的集章卡片" class="md-nav__link">
      游园会的集章卡片
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/hackergame2018/cat_remote/" title="猫咪遥控器" class="md-nav__link">
      猫咪遥控器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/hackergame2018/python_simulator/" title="猫咪克星" class="md-nav__link">
      猫咪克星
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      CG-CTF
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        CG-CTF
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-1" type="checkbox" id="nav-3-5-1">
    
    <label class="md-nav__link" for="nav-3-5-1">
      Web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-1">
        Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_writeup/cg_ctf/easyweb/" title="签到题" class="md-nav__link">
      签到题
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      EMBEDDED
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        EMBEDDED
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../embedded/clion-2019.1/" title="尝鲜CLion 2019.1（Windows）" class="md-nav__link">
      尝鲜CLion 2019.1（Windows）
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      READING NOTES
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        READING NOTES
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1">
    
    <label class="md-nav__link" for="nav-5-1">
      《深入理解计算机系统》
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-1">
        《深入理解计算机系统》
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reading_notes/computer_systems_a_programmer_s_perspective/machine-level_representation_of_programs/" title="第3章 程序的机器级表示" class="md-nav__link">
      第3章 程序的机器级表示
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      《Docker经典实例》
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        《Docker经典实例》
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reading_notes/docker_cookbook/1/" title="第1章 Docker入门" class="md-nav__link">
      第1章 Docker入门
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3">
    
    <label class="md-nav__link" for="nav-5-3">
      《揭秘家用路由器0day漏洞挖掘技术》读书笔记
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-3">
        《揭秘家用路由器0day漏洞挖掘技术》读书笔记
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reading_notes/routers/1/" title="第1章 基础准备与工具" class="md-nav__link">
      第1章 基础准备与工具
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4">
    
    <label class="md-nav__link" for="nav-5-4">
      《征服C指针》读书笔记
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-4">
        《征服C指针》读书笔记
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reading_notes/pointer/0/" title="第0章 本书的目标与结构——引言" class="md-nav__link">
      第0章 本书的目标与结构——引言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reading_notes/pointer/1/" title="第1章 从基础开始——预备知识和复习" class="md-nav__link">
      第1章 从基础开始——预备知识和复习
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      SZU COURSES
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        SZU COURSES
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">
    
    <label class="md-nav__link" for="nav-6-1">
      程序设计基础
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-1">
        程序设计基础
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/first/" title="前言" class="md-nav__link">
      前言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/books/" title="一些C语言相关的书目" class="md-nav__link">
      一些C语言相关的书目
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/clion_conf/" title="JetBrains CLion 安装与配置" class="md-nav__link">
      JetBrains CLion 安装与配置
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/clion_hotkeys/" title="一些使用CLion的技巧" class="md-nav__link">
      一些使用CLion的技巧
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/vector/" title="浅谈vector容器" class="md-nav__link">
      浅谈vector容器
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      Web开发及人机交互导论
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        Web开发及人机交互导论
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../web/first/" title="前言" class="md-nav__link">
      前言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../web/tools/" title="工欲善其事" class="md-nav__link">
      工欲善其事
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3" checked>
    
    <label class="md-nav__link" for="nav-6-3">
      计算机系统
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-3">
        计算机系统
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../datalab/" title="Data Lab" class="md-nav__link">
      Data Lab
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Bomb Lab
      </label>
    
    <a href="./" title="Bomb Lab" class="md-nav__link md-nav__link--active">
      Bomb Lab
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#main" title="main" class="md-nav__link">
    main
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_1" title="phase_1" class="md-nav__link">
    phase_1
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_2" title="phase_2" class="md-nav__link">
    phase_2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_3" title="phase_3" class="md-nav__link">
    phase_3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_4" title="phase_4" class="md-nav__link">
    phase_4
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_5" title="phase_5" class="md-nav__link">
    phase_5
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_6" title="phase_6" class="md-nav__link">
    phase_6
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secret_phase" title="secret_phase" class="md-nav__link">
    secret_phase
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flag" title="flag" class="md-nav__link">
    flag
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      计算机网络
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        计算机网络
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4-1" type="checkbox" id="nav-6-4-1">
    
    <label class="md-nav__link" for="nav-6-4-1">
      实验
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-4-1">
        实验
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cn/vlan_lab/" title="VLAN Lab" class="md-nav__link">
      VLAN Lab
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cn/transport_layer/" title="传输层" class="md-nav__link">
      传输层
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      SZU ONLINEJUDGE
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        SZU ONLINEJUDGE
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1">
    
    <label class="md-nav__link" for="nav-7-1">
      专题 What's wrong with my code?
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-1">
        专题 What's wrong with my code?
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/what_s_wrong_with_my_code/first/" title="前言" class="md-nav__link">
      前言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/what_s_wrong_with_my_code/initialize/" title="初始化的姿势" class="md-nav__link">
      初始化的姿势
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      面向对象程序设计
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-2">
        面向对象程序设计
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/oop/1038/" title="三串合一（指针与字符数组）" class="md-nav__link">
      三串合一（指针与字符数组）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/oop/1044/" title="动态矩阵（指针与堆内存分配）" class="md-nav__link">
      动态矩阵（指针与堆内存分配）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/oop/1190/" title="扑克牌排序（结构体）" class="md-nav__link">
      扑克牌排序（结构体）
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      程序设计基础
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-3">
        程序设计基础
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cpp/1084/" title="求矩阵的最大和最小值" class="md-nav__link">
      求矩阵的最大和最小值
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cpp/1295/" title="单词统计" class="md-nav__link">
      单词统计
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cpp/1341/" title="计算字符串的长度" class="md-nav__link">
      计算字符串的长度
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-4" type="checkbox" id="nav-7-4">
    
    <label class="md-nav__link" for="nav-7-4">
      程序设计基础 UOOC
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-4">
        程序设计基础 UOOC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/uooc/1334/" title="分类排序(函数)" class="md-nav__link">
      分类排序(函数)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/uooc/1438/" title="鸡蛋队列（数组，函数）" class="md-nav__link">
      鸡蛋队列（数组，函数）
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-5" type="checkbox" id="nav-7-5">
    
    <label class="md-nav__link" for="nav-7-5">
      数据结构
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-5">
        数据结构
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1199/" title="DS单链表--类实现" class="md-nav__link">
      DS单链表--类实现
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1202/" title="DS堆栈--逆序输出（STL栈使用）" class="md-nav__link">
      DS堆栈--逆序输出（STL栈使用）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1204/" title="DS堆栈--行编辑" class="md-nav__link">
      DS堆栈--行编辑
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1205/" title="DS堆栈--括号匹配" class="md-nav__link">
      DS堆栈--括号匹配
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1207/" title="DS队列之银行排队" class="md-nav__link">
      DS队列之银行排队
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1213/" title="DS二叉树--二叉树构建与遍历" class="md-nav__link">
      DS二叉树--二叉树构建与遍历
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1214/" title="DS二叉树--叶子数量" class="md-nav__link">
      DS二叉树--叶子数量
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1215/" title="DS二叉树--左叶子数量" class="md-nav__link">
      DS二叉树--左叶子数量
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1216/" title="DS二叉树——二叉树之父子结点" class="md-nav__link">
      DS二叉树——二叉树之父子结点
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1217/" title="DS二叉树——二叉树之数组存储" class="md-nav__link">
      DS二叉树——二叉树之数组存储
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1223/" title="DS图遍历--深度优先搜索" class="md-nav__link">
      DS图遍历--深度优先搜索
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1224/" title="DS图遍历--广度优先搜索" class="md-nav__link">
      DS图遍历--广度优先搜索
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1239/" title="DS哈希查找--链地址法" class="md-nav__link">
      DS哈希查找--链地址法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1241/" title="DS排序--快速排序" class="md-nav__link">
      DS排序--快速排序
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1245/" title="DS链表—学生宿舍管理" class="md-nav__link">
      DS链表—学生宿舍管理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1250/" title="DS二叉树——Huffman编码与解码" class="md-nav__link">
      DS二叉树——Huffman编码与解码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1253/" title="DS图—图的邻接矩阵存储及度计算" class="md-nav__link">
      DS图—图的邻接矩阵存储及度计算
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1260/" title="哈希查找与增补" class="md-nav__link">
      哈希查找与增补
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1264/" title="DS内排—直插排序" class="md-nav__link">
      DS内排—直插排序
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1268/" title="DS内排—2-路归并排序" class="md-nav__link">
      DS内排—2-路归并排序
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1269/" title="DS哈希查找—线性探测再散列" class="md-nav__link">
      DS哈希查找—线性探测再散列
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1309/" title="冒泡排序 (Ver. I)" class="md-nav__link">
      冒泡排序 (Ver. I)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/ds/1318/" title="DS哈希查找—二次探测再散列" class="md-nav__link">
      DS哈希查找—二次探测再散列
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      UOOC
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        UOOC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">
    
    <label class="md-nav__link" for="nav-8-1">
      Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-1">
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../uooc/java/1/" title="1 概述" class="md-nav__link">
      1 概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../uooc/java/2/" title="2 数据类型、运算符、表达式和跳转语句" class="md-nav__link">
      2 数据类型、运算符、表达式和跳转语句
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../uooc/java/3/" title="3 类和对象" class="md-nav__link">
      3 类和对象
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../uooc/java/4/" title="4 继承与接口" class="md-nav__link">
      4 继承与接口
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../uooc/java/5/" title="5 字符串及其应用" class="md-nav__link">
      5 字符串及其应用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../uooc/java/6/" title="6 泛型与集合" class="md-nav__link">
      6 泛型与集合
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../uooc/java/7/" title="7 例外处理" class="md-nav__link">
      7 例外处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../uooc/java/8/" title="8 File类与输入输出流" class="md-nav__link">
      8 File类与输入输出流
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../uooc/java/9/" title="9 图形用户界面设计" class="md-nav__link">
      9 图形用户界面设计
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../uooc/java/10/" title="10 线程" class="md-nav__link">
      10 线程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../uooc/java/11/" title="11 Java网络编程" class="md-nav__link">
      11 Java网络编程
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      MISC
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        MISC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/cmake_source_and_binary_directory/" title="CMake指定源码目录和构建目录" class="md-nav__link">
      CMake指定源码目录和构建目录
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/git_clone_via_ssh/" title="git clone 通过ssh" class="md-nav__link">
      git clone 通过ssh
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/python_http_server/" title="Python SimpleHTTPServer" class="md-nav__link">
      Python SimpleHTTPServer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/secure_public_wireless_network_at_school_szu/" title="在开放的校园无线网络中加密自己的数据传输" class="md-nav__link">
      在开放的校园无线网络中加密自己的数据传输
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#main" title="main" class="md-nav__link">
    main
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_1" title="phase_1" class="md-nav__link">
    phase_1
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_2" title="phase_2" class="md-nav__link">
    phase_2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_3" title="phase_3" class="md-nav__link">
    phase_3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_4" title="phase_4" class="md-nav__link">
    phase_4
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_5" title="phase_5" class="md-nav__link">
    phase_5
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase_6" title="phase_6" class="md-nav__link">
    phase_6
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secret_phase" title="secret_phase" class="md-nav__link">
    secret_phase
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flag" title="flag" class="md-nav__link">
    flag
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/szu17dmy/szu17dmy.github.io/edit/master/docs/szu_courses/csapp/bomblab.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Bomb Lab</h1>
                
                <p>这回来整理一下这题逆向。我是个学艺不精的默默无闻的对二进制了解不多的普通学生，做这个还是有点难度的，感谢队里的大佬<a href="https://apeng.fun/">@Apeng</a>带我。下面大概是我的解题过程，如果有问题或是错误，还望各位大佬指点。</p>
<p>题目存档：<a href="./problems/bomb_64">bomb_64</a> <a href="../problems/bomb_64.c">bomb_64.c</a></p>
<p>环境：openSUSE Tumbleweed + wine + IDA + Remote Linux debugger</p>
<p>因为我是实机Linux，所以“Remote” Linux debugger其实是在本地调试。如果你正在Windows下使用IDA，那么可能需要Linux虚拟机来进行调试。不管怎样，有可以实现的可靠的方法就行。</p>
<p>注意，下文中，由我手动还原的C代码仅供参考，并没有进行测试，可能存在问题。如果你发现了其中的问题，麻烦告诉我。</p>
<h2 id="main">main</h2>
<p>其实题目已经给出了main函数的相关内容：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cm">/* Do all sorts of secret stuff that makes the bomb harder to defuse. */</span>
<span class="n">initialize_bomb</span><span class="p">();</span>

<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Welcome to my fiendish little bomb. You have 6 phases with</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;which to blow yourself up. Have a nice day!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="cm">/* Hmm...  Six phases must be more secure than one phase! */</span>
<span class="n">input</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">();</span>             <span class="cm">/* Get input                   */</span>
<span class="n">phase_1</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>                  <span class="cm">/* Run the phase               */</span>
<span class="n">phase_defused</span><span class="p">();</span>                 <span class="cm">/* Drat!  They figured it out!</span>
<span class="cm">                  * Let me know how they did it. */</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Phase 1 defused. How about the next one?</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="cm">/* The second phase is harder.  No one will ever figure out</span>
<span class="cm"> * how to defuse this... */</span>
<span class="n">input</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">();</span>
<span class="n">phase_2</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<span class="n">phase_defused</span><span class="p">();</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;That&#39;s number 2.  Keep going!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="cm">/* I guess this is too easy so far.  Some more complex code will</span>
<span class="cm"> * confuse people. */</span>
<span class="n">input</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">();</span>
<span class="n">phase_3</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<span class="n">phase_defused</span><span class="p">();</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Halfway there!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="cm">/* Oh yeah?  Well, how good is your math?  Try on this saucy problem! */</span>
<span class="n">input</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">();</span>
<span class="n">phase_4</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<span class="n">phase_defused</span><span class="p">();</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;So you got that one.  Try this one.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="cm">/* Round and &#39;round in memory we go, where we stop, the bomb blows! */</span>
<span class="n">input</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">();</span>
<span class="n">phase_5</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<span class="n">phase_defused</span><span class="p">();</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Congratulations! You&#39;ve (mostly) defused the bomb!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hit Control-C to escape phase 6 (for free!), but if you want to</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;try phase 6 for extra credit, you can continue.  Just beware!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="cm">/* Oh, so you want more danger? Let&#39;s make this one extra hard. */</span>
<span class="n">input</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">();</span>
<span class="n">phase_6</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<span class="n">phase_defused</span><span class="p">();</span>

<span class="cm">/* Wow, they got it!  But isn&#39;t something... missing?  Perhaps</span>
<span class="cm"> * something they overlooked?  Mua ha ha ha ha! */</span>

<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</td></tr></table>

<p>看起来是有6个关卡，每次都需要有一段输入，合法则拆除炸弹，非法则炸弹爆炸。虽然已经知道是这样，但是我还是要F5一下：</p>
<p><img alt="BOMB-LAB_1.png" src="../img/BOMB-LAB_1.png" /></p>
<p>先在初始化<code>initialize_bomb()</code>后面加个断点，然后启动动态调试。</p>
<h2 id="phase_1">phase_1</h2>
<p>F8步进，在<code>phase_1()</code>函数前要求输入，我们先双击<code>phase_1</code>进去看看：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">phase_1</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax</span>

  <span class="n">result</span> <span class="o">=</span> <span class="n">strings_not_equal</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">a1</span><span class="p">,</span> <span class="s">&quot;Science isn&#39;t about why, it&#39;s about why not?&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">result</span> <span class="p">)</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="s">&quot;Science isn&#39;t about why, it&#39;s about why not?&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>非常明显，调用<code>strings_not_equal()</code>比较字符串，双击进入可看出要求输入的字符串和下述字符串</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>Science isn&#39;t about why, it&#39;s about why not?
</pre></div>
</td></tr></table>

<p>相等，如果不相等则调用<code>explode_bomb()</code>引爆炸弹。</p>
<p>再看看反汇编代码：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E70</span> <span class="c">; =============== S U B R O U T I N E =======================================</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E70</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E70</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E70</span> <span class="no">public</span> <span class="no">phase_1</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E70</span> <span class="no">phase_1</span> <span class="no">proc</span> <span class="no">near</span>                       <span class="c">; CODE XREF: main+90↑p</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E70</span> <span class="c">; __unwind {</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E70</span> <span class="no">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">8</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E74</span> <span class="no">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">offset</span> <span class="no">aScienceIsnTAbo</span>     <span class="c">; &quot;Science isn&#39;t about why, it&#39;s about why&quot;...</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E79</span> <span class="no">call</span>    <span class="no">strings_not_equal</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E7E</span> <span class="no">test</span>    <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E80</span> <span class="no">jz</span>      <span class="no">short</span> <span class="no">loc_400E87</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E82</span> <span class="no">call</span>    <span class="no">explode_bomb</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E87</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E87</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E87</span> <span class="no">loc_400E87</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_1+10↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E87</span> <span class="no">add</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">8</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8B</span> <span class="no">retn</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8B</span> <span class="c">; } // starts at 400E70</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8B</span> <span class="no">phase_1</span> <span class="no">endp</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8B</span>
</pre></div>
</td></tr></table>

<p>粗略地还原一下应该是：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">phase_1</span><span class="p">(</span><span class="kt">char</span> <span class="n">str</span><span class="p">[])</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">strings_not_equal</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="s">&quot;Science isn&#39;t about why, it&#39;s about why not?&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">explode_bomb</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>其中，</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">test</span>    <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
<span class="nf">jz</span>      <span class="no">short</span> <span class="no">loc_400E87</span>
</pre></div>
</td></tr></table>

<p>将eax和eax与运算后，检查结果是否为0。所以效果应该是eax为0的时候跳转。也可以写成：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</pre></div>
</td></tr></table>

<p><a href="https://stackoverflow.com/questions/147173/testl-eax-against-eax"><code>testl</code> eax against eax?</a></p>
<blockquote>
<p>The meaning of <code>test</code> is to AND the arguments together, and check the result for zero. So this code tests if EAX is zero or not. <code>je</code> will jump if zero.</p>
<p>BTW, this generates a smaller instruction than <code>cmp eax, 0</code> which is the reason that compilers will generally do it this way.</p>
</blockquote>
<p>对于<code>strings_not_equal()</code>来说：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span> <span class="c">; =============== S U B R O U T I N E =======================================</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span> <span class="no">public</span> <span class="no">strings_not_equal</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span> <span class="no">strings_not_equal</span> <span class="no">proc</span> <span class="no">near</span>             <span class="c">; CODE XREF: phase_1+9↑p</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span>                                         <span class="c">; phase_defused+3A↓p</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span> <span class="no">var_18</span><span class="err">=</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span> <span class="no">var_10</span><span class="err">=</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">10</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span> <span class="no">var_8</span><span class="err">=</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span> <span class="c">; __unwind {</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">D</span> <span class="no">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="no">var_18</span><span class="p">],</span> <span class="no">rbx</span>
<span class="nl">.text:</span><span class="err">0000000000401242</span> <span class="nf">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="no">var_10</span><span class="p">],</span> <span class="no">rbp</span>
<span class="nl">.text:</span><span class="err">0000000000401247</span> <span class="nf">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="no">var_8</span><span class="p">],</span> <span class="no">r12</span>
<span class="nl">.text:</span><span class="err">000000000040124</span><span class="nf">C</span> <span class="no">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000401250</span> <span class="nf">mov</span>     <span class="no">rbx</span><span class="p">,</span> <span class="no">rdi</span>
<span class="nl">.text:</span><span class="err">0000000000401253</span> <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsi</span>
<span class="nl">.text:</span><span class="err">0000000000401256</span> <span class="nf">call</span>    <span class="no">string_length</span>
<span class="nl">.text:</span><span class="err">000000000040125</span><span class="nf">B</span> <span class="no">mov</span>     <span class="no">r12d</span><span class="p">,</span> <span class="no">eax</span>
<span class="nl">.text:</span><span class="err">000000000040125</span><span class="nf">E</span> <span class="no">mov</span>     <span class="no">rdi</span><span class="p">,</span> <span class="no">rbp</span>
<span class="nl">.text:</span><span class="err">0000000000401261</span> <span class="nf">call</span>    <span class="no">string_length</span>
<span class="nl">.text:</span><span class="err">0000000000401266</span> <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">1</span>
<span class="nl">.text:</span><span class="err">000000000040126</span><span class="nf">B</span> <span class="no">cmp</span>     <span class="no">r12d</span><span class="p">,</span> <span class="no">eax</span>
<span class="nl">.text:</span><span class="err">000000000040126</span><span class="nf">E</span> <span class="no">jnz</span>     <span class="no">short</span> <span class="no">loc_4012A6</span>
<span class="nl">.text:</span><span class="err">0000000000401270</span> <span class="nf">movzx</span>   <span class="no">eax</span><span class="p">,</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">rbx</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000401273</span> <span class="nf">mov</span>     <span class="no">dl</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000401275</span> <span class="nf">test</span>    <span class="no">al</span><span class="p">,</span> <span class="no">al</span>
<span class="nl">.text:</span><span class="err">0000000000401277</span> <span class="nf">jz</span>      <span class="no">short</span> <span class="no">loc_4012A6</span>
<span class="nl">.text:</span><span class="err">0000000000401279</span> <span class="nf">mov</span>     <span class="no">dl</span><span class="p">,</span> <span class="mi">1</span>
<span class="nl">.text:</span><span class="err">000000000040127</span><span class="nf">B</span> <span class="no">cmp</span>     <span class="no">al</span><span class="p">,</span> <span class="p">[</span><span class="no">rbp</span><span class="err">+</span><span class="mi">0</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">000000000040127</span><span class="nf">E</span> <span class="no">jnz</span>     <span class="no">short</span> <span class="no">loc_4012A6</span>
<span class="nl">.text:</span><span class="err">0000000000401280</span> <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000401285</span> <span class="nf">jmp</span>     <span class="no">short</span> <span class="no">loc_401291</span>
<span class="nl">.text:</span><span class="err">0000000000401287</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000401287</span>
<span class="nl">.text:</span><span class="err">0000000000401287</span> <span class="nl">loc_401287:</span>                             <span class="c">; CODE XREF: strings_not_equal+5B↓j</span>
<span class="nl">.text:</span><span class="err">0000000000401287</span> <span class="nf">add</span>     <span class="no">rax</span><span class="p">,</span> <span class="mi">1</span>
<span class="nl">.text:</span><span class="err">000000000040128</span><span class="nf">B</span> <span class="no">cmp</span>     <span class="no">dl</span><span class="p">,</span> <span class="p">[</span><span class="no">rbp</span><span class="err">+</span><span class="no">rax</span><span class="err">+</span><span class="mi">0</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">000000000040128</span><span class="nf">F</span> <span class="no">jnz</span>     <span class="no">short</span> <span class="no">loc_4012A1</span>
<span class="nl">.text:</span><span class="err">0000000000401291</span>
<span class="nl">.text:</span><span class="err">0000000000401291</span> <span class="nl">loc_401291:</span>                             <span class="c">; CODE XREF: strings_not_equal+48↑j</span>
<span class="nl">.text:</span><span class="err">0000000000401291</span> <span class="nf">movzx</span>   <span class="no">edx</span><span class="p">,</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">rbx</span><span class="err">+</span><span class="no">rax</span><span class="err">+</span><span class="mi">1</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000401296</span> <span class="nf">test</span>    <span class="no">dl</span><span class="p">,</span> <span class="no">dl</span>
<span class="nl">.text:</span><span class="err">0000000000401298</span> <span class="nf">jnz</span>     <span class="no">short</span> <span class="no">loc_401287</span>
<span class="nl">.text:</span><span class="err">000000000040129</span><span class="nf">A</span> <span class="no">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">000000000040129</span><span class="nf">F</span> <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_4012A6</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">A1</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">A1</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">A1</span> <span class="no">loc_4012A1</span><span class="p">:</span>                             <span class="c">; CODE XREF: strings_not_equal+52↑j</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">A1</span> <span class="no">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">1</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">A6</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">A6</span> <span class="no">loc_4012A6</span><span class="p">:</span>                             <span class="c">; CODE XREF: strings_not_equal+31↑j</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">A6</span>                                         <span class="c">; strings_not_equal+3A↑j ...</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">A6</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">edx</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">A8</span> <span class="no">mov</span>     <span class="no">rbx</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_18</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">AC</span> <span class="no">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_10</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">B1</span> <span class="no">mov</span>     <span class="no">r12</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_8</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">B6</span> <span class="no">add</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">BA</span> <span class="no">retn</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">BA</span> <span class="c">; } // starts at 40123D</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">BA</span> <span class="no">strings_not_equal</span> <span class="no">endp</span>
<span class="nl">.text:</span><span class="err">00000000004012</span><span class="nf">BA</span>
</pre></div>
</td></tr></table>

<p>勉强还原成这样，看着十分别扭，也好像有很多废话：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="nf">strings_not_equal</span><span class="p">(</span><span class="kt">char</span> <span class="n">str1</span><span class="p">[],</span> <span class="kt">char</span> <span class="n">str2</span><span class="p">[])</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">str1_length</span> <span class="o">=</span> <span class="n">string_length</span><span class="p">(</span><span class="n">str1</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">str2_length</span> <span class="o">=</span> <span class="n">string_length</span><span class="p">(</span><span class="n">str2</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">str1_length</span> <span class="o">==</span> <span class="n">str2_length</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">str1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">str1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">str2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
                <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">while</span> <span class="p">(</span><span class="n">str1</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">str1</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">str2</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="n">flag</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">flag</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>对于<code>string_length()</code>来说：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.text:</span><span class="err">0000000000401221</span> <span class="c">; =============== S U B R O U T I N E =======================================</span>
<span class="nl">.text:</span><span class="err">0000000000401221</span>
<span class="nl">.text:</span><span class="err">0000000000401221</span>
<span class="nl">.text:</span><span class="err">0000000000401221</span> <span class="nf">public</span> <span class="no">string_length</span>
<span class="nl">.text:</span><span class="err">0000000000401221</span> <span class="nf">string_length</span> <span class="no">proc</span> <span class="no">near</span>                 <span class="c">; CODE XREF: strings_not_equal+19↓p</span>
<span class="nl">.text:</span><span class="err">0000000000401221</span>                                         <span class="c">; strings_not_equal+24↓p</span>
<span class="nl">.text:</span><span class="err">0000000000401221</span> <span class="c">; __unwind {</span>
<span class="nl">.text:</span><span class="err">0000000000401221</span> <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000401226</span> <span class="nf">cmp</span>     <span class="no">byte</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">rdi</span><span class="p">],</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000401229</span> <span class="nf">jz</span>      <span class="no">short</span> <span class="no">locret_40123B</span>
<span class="nl">.text:</span><span class="err">000000000040122</span><span class="nf">B</span> <span class="no">mov</span>     <span class="no">rdx</span><span class="p">,</span> <span class="no">rdi</span>
<span class="nl">.text:</span><span class="err">000000000040122</span><span class="nf">E</span>
<span class="nl">.text:</span><span class="err">000000000040122</span><span class="nf">E</span> <span class="no">loc_40122E</span><span class="p">:</span>                             <span class="c">; CODE XREF: string_length+18↓j</span>
<span class="nl">.text:</span><span class="err">000000000040122</span><span class="nf">E</span> <span class="no">add</span>     <span class="no">rdx</span><span class="p">,</span> <span class="mi">1</span>
<span class="nl">.text:</span><span class="err">0000000000401232</span> <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">edx</span>
<span class="nl">.text:</span><span class="err">0000000000401234</span> <span class="nf">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">edi</span>
<span class="nl">.text:</span><span class="err">0000000000401236</span> <span class="nf">cmp</span>     <span class="no">byte</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">rdx</span><span class="p">],</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000401239</span> <span class="nf">jnz</span>     <span class="no">short</span> <span class="no">loc_40122E</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">B</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">B</span> <span class="no">locret_40123B</span><span class="p">:</span>                          <span class="c">; CODE XREF: string_length+8↑j</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">B</span> <span class="no">rep</span> <span class="no">retn</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">B</span> <span class="c">; } // starts at 401221</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">B</span> <span class="no">string_length</span> <span class="no">endp</span>
<span class="nl">.text:</span><span class="err">000000000040123</span><span class="nf">B</span>
</pre></div>
</td></tr></table>

<p>大概可以还原成：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="nf">string_length</span><span class="p">(</span><span class="kt">char</span> <span class="n">str</span><span class="p">[])</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">char</span> <span class="o">*</span><span class="n">ptr</span> <span class="o">=</span> <span class="n">str</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="o">*</span><span class="n">ptr</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ptr</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">ptr</span> <span class="o">-</span> <span class="n">str</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">length</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>所以，我们只需要输入：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>Science isn&#39;t about why, it&#39;s about why not?
</pre></div>
</td></tr></table>

<p>就可以通过第一个check。</p>
<h2 id="phase_2">phase_2</h2>
<p>先F5看看：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">phase_2</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">v1</span><span class="p">;</span> <span class="c1">// rbp</span>
  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// er12</span>
  <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax</span>
  <span class="kr">__int64</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [rsp+0h] [rbp-48h]</span>
  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [rsp+Ch] [rbp-3Ch]</span>

  <span class="n">read_six_numbers</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v4</span><span class="p">);</span>
  <span class="n">v1</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v4</span><span class="p">;</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">do</span>
  <span class="p">{</span>
    <span class="n">result</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">v1</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v1</span> <span class="o">!=</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">result</span> <span class="p">)</span>
      <span class="n">explode_bomb</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="p">);</span>
    <span class="n">v2</span> <span class="o">+=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v1</span><span class="p">;</span>
    <span class="n">v1</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">while</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">!=</span> <span class="o">&amp;</span><span class="n">v5</span> <span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v2</span> <span class="p">)</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>看起来似乎很简单...但是除了<code>read_six_numbers()</code>我似乎没看懂什么。还是来看看汇编好了：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span> <span class="c">; =============== S U B R O U T I N E =======================================</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span> <span class="no">public</span> <span class="no">phase_2</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span> <span class="no">phase_2</span> <span class="no">proc</span> <span class="no">near</span>                       <span class="c">; CODE XREF: main+AC↑p</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span> <span class="no">var_3C</span><span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">3</span><span class="no">Ch</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span> <span class="no">var_20</span><span class="err">=</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">20</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span> <span class="no">var_18</span><span class="err">=</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span> <span class="no">var_10</span><span class="err">=</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">10</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span> <span class="no">var_8</span><span class="err">=</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span> <span class="c">; __unwind {</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E8C</span> <span class="no">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="no">var_20</span><span class="p">],</span> <span class="no">rbx</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E91</span> <span class="no">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="no">var_18</span><span class="p">],</span> <span class="no">rbp</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E96</span> <span class="no">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="no">var_10</span><span class="p">],</span> <span class="no">r12</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">E9B</span> <span class="no">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="no">var_8</span><span class="p">],</span> <span class="no">r13</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EA0</span> <span class="no">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">48</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EA4</span> <span class="no">mov</span>     <span class="no">rsi</span><span class="p">,</span> <span class="no">rsp</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EA7</span> <span class="no">call</span>    <span class="no">read_six_numbers</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EAC</span> <span class="no">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EAF</span> <span class="no">lea</span>     <span class="no">r13</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">48</span><span class="no">h</span><span class="err">+</span><span class="no">var_3C</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EB4</span> <span class="no">mov</span>     <span class="no">r12d</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EBA</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EBA</span> <span class="no">loc_400EBA</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_2+48↓j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EBA</span> <span class="no">mov</span>     <span class="no">rbx</span><span class="p">,</span> <span class="no">rbp</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EBD</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">rbp</span><span class="err">+</span><span class="mi">0</span><span class="no">Ch</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EC0</span> <span class="no">cmp</span>     <span class="p">[</span><span class="no">rbp</span><span class="err">+</span><span class="mi">0</span><span class="p">],</span> <span class="no">eax</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EC3</span> <span class="no">jz</span>      <span class="no">short</span> <span class="no">loc_400ECA</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EC5</span> <span class="no">call</span>    <span class="no">explode_bomb</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">ECA</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">ECA</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">ECA</span> <span class="no">loc_400ECA</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_2+37↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">ECA</span> <span class="no">add</span>     <span class="no">r12d</span><span class="p">,</span> <span class="p">[</span><span class="no">rbx</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">ECD</span> <span class="no">add</span>     <span class="no">rbp</span><span class="p">,</span> <span class="mi">4</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">ED1</span> <span class="no">cmp</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">r13</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">ED4</span> <span class="no">jnz</span>     <span class="no">short</span> <span class="no">loc_400EBA</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">ED6</span> <span class="no">test</span>    <span class="no">r12d</span><span class="p">,</span> <span class="no">r12d</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">ED9</span> <span class="no">jnz</span>     <span class="no">short</span> <span class="no">loc_400EE0</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EDB</span> <span class="no">call</span>    <span class="no">explode_bomb</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EE0</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EE0</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EE0</span> <span class="no">loc_400EE0</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_2+4D↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EE0</span> <span class="no">mov</span>     <span class="no">rbx</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">48</span><span class="no">h</span><span class="err">+</span><span class="no">var_20</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EE5</span> <span class="no">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">48</span><span class="no">h</span><span class="err">+</span><span class="no">var_18</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EEA</span> <span class="no">mov</span>     <span class="no">r12</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">48</span><span class="no">h</span><span class="err">+</span><span class="no">var_10</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EEF</span> <span class="no">mov</span>     <span class="no">r13</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">48</span><span class="no">h</span><span class="err">+</span><span class="no">var_8</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF4</span> <span class="no">add</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">48</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF8</span> <span class="no">retn</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF8</span> <span class="c">; } // starts at 400E8C</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF8</span> <span class="no">phase_2</span> <span class="no">endp</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF8</span>
</pre></div>
</td></tr></table>

<p>可以这样还原：</p>
<p>对了，希望你已经知道了<code>a[i]</code>是<code>*(a+i)</code>的语法糖。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">phase_2</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
    <span class="n">read_six_numbers</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">array</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="o">*</span><span class="n">ptr</span> <span class="o">=</span> <span class="n">arrray</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">ptr</span> <span class="o">!=</span> <span class="p">(</span><span class="n">array</span> <span class="o">+</span> <span class="mi">3</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ptr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ptr</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="p">{</span>
            <span class="n">explode_bomb</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="n">sum</span> <span class="o">+=</span> <span class="o">*</span><span class="n">ptr</span><span class="p">;</span>
        <span class="n">ptr</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">explode_bomb</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>看起来像是输入6个数字，前三个和后三个需要分别相等，并且不能全为0。</p>
<p>看看<code>read_six_numbers()</code>：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.text:</span><span class="err">0000000000401743</span> <span class="c">; =============== S U B R O U T I N E =======================================</span>
<span class="nl">.text:</span><span class="err">0000000000401743</span>
<span class="nl">.text:</span><span class="err">0000000000401743</span>
<span class="nl">.text:</span><span class="err">0000000000401743</span> <span class="nf">public</span> <span class="no">read_six_numbers</span>
<span class="nl">.text:</span><span class="err">0000000000401743</span> <span class="nf">read_six_numbers</span> <span class="no">proc</span> <span class="no">near</span>              <span class="c">; CODE XREF: phase_2+1B↑p</span>
<span class="nl">.text:</span><span class="err">0000000000401743</span>
<span class="nl">.text:</span><span class="err">0000000000401743</span> <span class="nf">var_18</span><span class="err">=</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000401743</span> <span class="nf">var_10</span><span class="err">=</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">10</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000401743</span>
<span class="nl">.text:</span><span class="err">0000000000401743</span> <span class="c">; __unwind {</span>
<span class="nl">.text:</span><span class="err">0000000000401743</span> <span class="nf">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000401747</span> <span class="nf">mov</span>     <span class="no">rdx</span><span class="p">,</span> <span class="no">rsi</span>
<span class="nl">.text:</span><span class="err">000000000040174</span><span class="nf">A</span> <span class="no">lea</span>     <span class="no">rcx</span><span class="p">,</span> <span class="p">[</span><span class="no">rsi</span><span class="err">+</span><span class="mi">4</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">000000000040174</span><span class="nf">E</span> <span class="no">lea</span>     <span class="no">rax</span><span class="p">,</span> <span class="p">[</span><span class="no">rsi</span><span class="err">+</span><span class="mi">14</span><span class="no">h</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000401752</span> <span class="nf">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_10</span><span class="p">],</span> <span class="no">rax</span>
<span class="nl">.text:</span><span class="err">0000000000401757</span> <span class="nf">lea</span>     <span class="no">rax</span><span class="p">,</span> <span class="p">[</span><span class="no">rsi</span><span class="err">+</span><span class="mi">10</span><span class="no">h</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">000000000040175</span><span class="nf">B</span> <span class="no">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_18</span><span class="p">],</span> <span class="no">rax</span>
<span class="nl">.text:</span><span class="err">000000000040175</span><span class="nf">F</span> <span class="no">lea</span>     <span class="no">r9</span><span class="p">,</span> <span class="p">[</span><span class="no">rsi</span><span class="err">+</span><span class="mi">0</span><span class="no">Ch</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000401763</span> <span class="nf">lea</span>     <span class="no">r8</span><span class="p">,</span> <span class="p">[</span><span class="no">rsi</span><span class="err">+</span><span class="mi">8</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000401767</span> <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">offset</span> <span class="no">unk_401EB2</span>
<span class="nl">.text:</span><span class="err">000000000040176</span><span class="nf">C</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000401771</span> <span class="nf">call</span>    <span class="no">___isoc99_sscanf</span>
<span class="nl">.text:</span><span class="err">0000000000401776</span> <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">5</span>
<span class="nl">.text:</span><span class="err">0000000000401779</span> <span class="nf">jg</span>      <span class="no">short</span> <span class="no">loc_401780</span>
<span class="nl">.text:</span><span class="err">000000000040177</span><span class="nf">B</span> <span class="no">call</span>    <span class="no">explode_bomb</span>
<span class="nl">.text:</span><span class="err">0000000000401780</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000401780</span>
<span class="nl">.text:</span><span class="err">0000000000401780</span> <span class="nl">loc_401780:</span>                             <span class="c">; CODE XREF: read_six_numbers+36↑j</span>
<span class="nl">.text:</span><span class="err">0000000000401780</span> <span class="nf">add</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000401784</span> <span class="nf">retn</span>
<span class="nl">.text:</span><span class="err">0000000000401784</span> <span class="c">; } // starts at 401743</span>
<span class="nl">.text:</span><span class="err">0000000000401784</span> <span class="nf">read_six_numbers</span> <span class="no">endp</span>
<span class="nl">.text:</span><span class="err">0000000000401784</span>
</pre></div>
</td></tr></table>

<p>应该可以还原成：（省略了部分内容）</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">read_six_numbers</span><span class="p">(</span><span class="kt">char</span> <span class="n">arg1</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">array</span><span class="p">[])</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d %d %d %d %d %d&quot;</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">array</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">array</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">array</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">array</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">array</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">explode_bomb</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>综上，随意构造前三个和后三个数字相等且不全为0的六个数字即可，例如：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>1 2 3 1 2 3
</pre></div>
</td></tr></table>

<p>应该能通过第二个check。</p>
<h2 id="phase_3">phase_3</h2>
<p>还是先进来F5：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">signed</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">phase_3</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a4</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a5</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a6</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">signed</span> <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax</span>
  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [rsp+8h] [rbp-10h]</span>
  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+Ch] [rbp-Ch]</span>

  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">__isoc99_sscanf</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="s">&quot;%d %d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v8</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v7</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="s">&quot;%d %d&quot;</span><span class="p">);</span>
  <span class="k">switch</span> <span class="p">(</span> <span class="n">v8</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
      <span class="n">result</span> <span class="o">=</span> <span class="mi">535LL</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
      <span class="n">result</span> <span class="o">=</span> <span class="mi">926LL</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
      <span class="n">result</span> <span class="o">=</span> <span class="mi">214LL</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
      <span class="n">result</span> <span class="o">=</span> <span class="mi">339LL</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
      <span class="n">result</span> <span class="o">=</span> <span class="mi">119LL</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
      <span class="n">result</span> <span class="o">=</span> <span class="mi">352LL</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">6</span><span class="o">:</span>
      <span class="n">result</span> <span class="o">=</span> <span class="mi">919LL</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">7</span><span class="o">:</span>
      <span class="n">result</span> <span class="o">=</span> <span class="mi">412LL</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">default</span><span class="o">:</span>
      <span class="n">explode_bomb</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="s">&quot;%d %d&quot;</span><span class="p">);</span>
      <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">result</span> <span class="o">!=</span> <span class="n">v7</span> <span class="p">)</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="s">&quot;%d %d&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>这一关已经看得相当清楚了目前，不过我们还是来看看汇编：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF9</span> <span class="c">; =============== S U B R O U T I N E =======================================</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF9</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF9</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF9</span> <span class="no">public</span> <span class="no">phase_3</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF9</span> <span class="no">phase_3</span> <span class="no">proc</span> <span class="no">near</span>                       <span class="c">; CODE XREF: main+C8↑p</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF9</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF9</span> <span class="no">var_10</span><span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">10</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF9</span> <span class="no">var_C</span><span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF9</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF9</span> <span class="c">; __unwind {</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EF9</span> <span class="no">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">EFD</span> <span class="no">lea</span>     <span class="no">rcx</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_10</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F02</span> <span class="no">lea</span>     <span class="no">rdx</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F07</span> <span class="no">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">offset</span> <span class="no">aDD</span>                 <span class="c">; &quot;%d %d&quot;</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F0C</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F11</span> <span class="no">call</span>    <span class="no">___isoc99_sscanf</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F16</span> <span class="no">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">1</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F19</span> <span class="no">jg</span>      <span class="no">short</span> <span class="no">loc_400F20</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F1B</span> <span class="no">call</span>    <span class="no">explode_bomb</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F20</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F20</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F20</span> <span class="no">loc_400F20</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+20↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F20</span> <span class="no">cmp</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_C</span><span class="p">],</span> <span class="mi">7</span>              <span class="c">; switch 8 cases</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F25</span> <span class="no">ja</span>      <span class="no">short</span> <span class="no">loc_400F63</span>                <span class="c">; jumptable 0000000000400F2B default case</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F27</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F2B</span> <span class="no">jmp</span>     <span class="no">ds</span><span class="p">:</span><span class="no">off_401B60</span><span class="p">[</span><span class="no">rax</span><span class="p">*</span><span class="mi">8</span><span class="p">]</span>            <span class="c">; switch jump</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F32</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F32</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F32</span> <span class="no">loc_400F32</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+32↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F32</span>                                         <span class="c">; DATA XREF: .rodata:off_401B60↓o</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F32</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">217</span><span class="no">h</span>                       <span class="c">; jumptable 0000000000400F2B case 0</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F37</span> <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_400F74</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F39</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F39</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F39</span> <span class="no">loc_400F39</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+32↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F39</span>                                         <span class="c">; DATA XREF: .rodata:off_401B60↓o</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F39</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">D6h</span>                       <span class="c">; jumptable 0000000000400F2B case 2</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F3E</span> <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_400F74</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F40</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F40</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F40</span> <span class="no">loc_400F40</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+32↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F40</span>                                         <span class="c">; DATA XREF: .rodata:off_401B60↓o</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F40</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">153</span><span class="no">h</span>                       <span class="c">; jumptable 0000000000400F2B case 3</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F45</span> <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_400F74</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F47</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F47</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F47</span> <span class="no">loc_400F47</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+32↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F47</span>                                         <span class="c">; DATA XREF: .rodata:off_401B60↓o</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F47</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">77</span><span class="no">h</span>                        <span class="c">; jumptable 0000000000400F2B case 4</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F4C</span> <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_400F74</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F4E</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F4E</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F4E</span> <span class="no">loc_400F4E</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+32↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F4E</span>                                         <span class="c">; DATA XREF: .rodata:off_401B60↓o</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F4E</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">160</span><span class="no">h</span>                       <span class="c">; jumptable 0000000000400F2B case 5</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F53</span> <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_400F74</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F55</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F55</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F55</span> <span class="no">loc_400F55</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+32↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F55</span>                                         <span class="c">; DATA XREF: .rodata:off_401B60↓o</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F55</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">397</span><span class="no">h</span>                       <span class="c">; jumptable 0000000000400F2B case 6</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F5A</span> <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_400F74</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F5C</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F5C</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F5C</span> <span class="no">loc_400F5C</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+32↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F5C</span>                                         <span class="c">; DATA XREF: .rodata:off_401B60↓o</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F5C</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">19</span><span class="no">Ch</span>                       <span class="c">; jumptable 0000000000400F2B case 7</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F61</span> <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_400F74</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F63</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F63</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F63</span> <span class="no">loc_400F63</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+2C↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F63</span> <span class="no">call</span>    <span class="no">explode_bomb</span>                    <span class="c">; jumptable 0000000000400F2B default case</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F68</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F68</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F6D</span> <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_400F74</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F6F</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F6F</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F6F</span> <span class="no">loc_400F6F</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+32↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F6F</span>                                         <span class="c">; DATA XREF: .rodata:off_401B60↓o</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F6F</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">39</span><span class="no">Eh</span>                       <span class="c">; jumptable 0000000000400F2B case 1</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F74</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F74</span> <span class="no">loc_400F74</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+3E↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F74</span>                                         <span class="c">; phase_3+45↑j ...</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F74</span> <span class="no">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_10</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F78</span> <span class="no">jz</span>      <span class="no">short</span> <span class="no">loc_400F7F</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F7A</span> <span class="no">call</span>    <span class="no">explode_bomb</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F7F</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F7F</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F7F</span> <span class="no">loc_400F7F</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_3+7F↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F7F</span> <span class="no">add</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F83</span> <span class="no">retn</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F83</span> <span class="c">; } // starts at 400EF9</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F83</span> <span class="no">phase_3</span> <span class="no">endp</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F83</span>
</pre></div>
</td></tr></table>

<p>已经不需要我再复原一遍了。当前关卡需要输入两个整数，这两个整数需要为：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>0 535
1 926
2 214
3 339
4 119
5 352
6 919
7 412
</pre></div>
</td></tr></table>

<p>中的一对，否则将会调用<code>explode_bomb()</code>引爆炸弹。</p>
<p>所以，给出上述整数对中的任意一对即可通过第三个check。</p>
<h2 id="phase_4">phase_4</h2>
<p>继续步进，还是F5：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">phase_4</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a4</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a5</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a6</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kr">__int64</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// rdi</span>
  <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax</span>
  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+Ch] [rbp-Ch]</span>

  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">__isoc99_sscanf</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="mi">4202177LL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v8</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">v8</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="mi">4202177LL</span><span class="p">);</span>
  <span class="n">v6</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v8</span><span class="p">;</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">func4</span><span class="p">(</span><span class="n">v8</span><span class="p">,</span> <span class="mi">4202177LL</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">result</span> <span class="o">!=</span> <span class="mi">55</span> <span class="p">)</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="mi">4202177LL</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>这看起来像是需要输入一个非负整数，让它经过<code>func4()</code>计算后得到<code>55</code>，否则就会触发<code>explode_bomb()</code>引爆炸弹。所以我们来看看<code>func4()</code>里面有什么：</p>
<p>嗯，还是F5。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">signed</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">func4</span><span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span> <span class="n">a1</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">signed</span> <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax</span>
  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// ebp</span>

  <span class="n">result</span> <span class="o">=</span> <span class="mi">1LL</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">a1</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="n">func4</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)(</span><span class="n">a1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">a2</span><span class="p">);</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">+</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">func4</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)(</span><span class="n">a1</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="n">a2</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>相当明显了，这应该是一个递归计算斐波纳契数列的函数。</p>
<p>还是来看看汇编：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC1</span> <span class="c">; =============== S U B R O U T I N E =======================================</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC1</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC1</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC1</span> <span class="no">public</span> <span class="no">phase_4</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC1</span> <span class="no">phase_4</span> <span class="no">proc</span> <span class="no">near</span>                       <span class="c">; CODE XREF: main+E4↑p</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC1</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC1</span> <span class="no">var_C</span><span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC1</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC1</span> <span class="c">; __unwind {</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC1</span> <span class="no">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC5</span> <span class="no">lea</span>     <span class="no">rdx</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FCA</span> <span class="no">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="mi">401</span><span class="no">EC1h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FCF</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FD4</span> <span class="no">call</span>    <span class="no">___isoc99_sscanf</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FD9</span> <span class="no">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">1</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FDC</span> <span class="no">jnz</span>     <span class="no">short</span> <span class="no">loc_400FE5</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FDE</span> <span class="no">cmp</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_C</span><span class="p">],</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FE3</span> <span class="no">jg</span>      <span class="no">short</span> <span class="no">loc_400FEA</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FE5</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FE5</span> <span class="no">loc_400FE5</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_4+1B↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FE5</span> <span class="no">call</span>    <span class="no">explode_bomb</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FEA</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FEA</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FEA</span> <span class="no">loc_400FEA</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_4+22↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FEA</span> <span class="no">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FEE</span> <span class="no">call</span>    <span class="no">func4</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FF3</span> <span class="no">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">37</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FF6</span> <span class="no">jz</span>      <span class="no">short</span> <span class="no">loc_400FFD</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FF8</span> <span class="no">call</span>    <span class="no">explode_bomb</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FFD</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FFD</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FFD</span> <span class="no">loc_400FFD</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_4+35↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FFD</span> <span class="no">add</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000401001</span> <span class="nf">retn</span>
<span class="nl">.text:</span><span class="err">0000000000401001</span> <span class="c">; } // starts at 400FC1</span>
<span class="nl">.text:</span><span class="err">0000000000401001</span> <span class="nf">phase_4</span> <span class="no">endp</span>
<span class="nl">.text:</span><span class="err">0000000000401001</span>
</pre></div>
</td></tr></table>

<p>可能可以是这样：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">phase_4</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">number</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">number</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">explode_bomb</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">func4</span><span class="p">(</span><span class="n">number</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">55</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">explode_bomb</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>至于<code>func4()</code>函数：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span> <span class="c">; =============== S U B R O U T I N E =======================================</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span> <span class="no">public</span> <span class="no">func4</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span> <span class="no">func4</span> <span class="no">proc</span> <span class="no">near</span>                         <span class="c">; CODE XREF: func4+1D↓p</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span>                                         <span class="c">; func4+27↓p ...</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span> <span class="no">var_10</span><span class="err">=</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">10</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span> <span class="no">var_8</span><span class="err">=</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span> <span class="c">; __unwind {</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F84</span> <span class="no">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="no">var_10</span><span class="p">],</span> <span class="no">rbx</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F89</span> <span class="no">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="no">var_8</span><span class="p">],</span> <span class="no">rbp</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F8E</span> <span class="no">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F92</span> <span class="no">mov</span>     <span class="no">ebx</span><span class="p">,</span> <span class="no">edi</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F94</span> <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">1</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F99</span> <span class="no">cmp</span>     <span class="no">edi</span><span class="p">,</span> <span class="mi">1</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F9C</span> <span class="no">jle</span>     <span class="no">short</span> <span class="no">loc_400FB2</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">F9E</span> <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">rbx-1</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FA1</span> <span class="no">call</span>    <span class="no">func4</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FA6</span> <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">eax</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FA8</span> <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">rbx-2</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FAB</span> <span class="no">call</span>    <span class="no">func4</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FB0</span> <span class="no">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FB2</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FB2</span> <span class="no">loc_400FB2</span><span class="p">:</span>                             <span class="c">; CODE XREF: func4+18↑j</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FB2</span> <span class="no">mov</span>     <span class="no">rbx</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_10</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FB7</span> <span class="no">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_8</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FBC</span> <span class="no">add</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC0</span> <span class="no">retn</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC0</span> <span class="c">; } // starts at 400F84</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC0</span> <span class="no">func4</span> <span class="no">endp</span>
<span class="nl">.text:</span><span class="err">0000000000400</span><span class="nf">FC0</span>
</pre></div>
</td></tr></table>

<p>可能是这样：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="nf">func4</span><span class="p">(</span><span class="kt">int</span> <span class="n">number</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">number</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">func4</span><span class="p">(</span><span class="n">number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">func4</span><span class="p">(</span><span class="n">number</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>综上，由于斐波那契数列是：</p>
<blockquote>
<p>1 2 3 5 8 13 21 34 55</p>
</blockquote>
<p>所以，只要给定：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>9
</pre></div>
</td></tr></table>

<p>，即第9个数字，就可通过第四个check。</p>
<h2 id="phase_5">phase_5</h2>
<p>还是先F5一下：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">phase_5</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a4</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a5</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a6</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax</span>
  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// ecx</span>
  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// edx</span>
  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [rsp+8h] [rbp-10h]</span>
  <span class="kt">int</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+Ch] [rbp-Ch]</span>

  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">__isoc99_sscanf</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="s">&quot;%d %d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v10</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v9</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="s">&quot;%d %d&quot;</span><span class="p">);</span>
  <span class="n">LODWORD</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">=</span> <span class="n">v10</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">;</span>
  <span class="n">v10</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">result</span> <span class="o">==</span> <span class="mi">15</span> <span class="p">)</span>
    <span class="k">goto</span> <span class="n">LABEL_11</span><span class="p">;</span>
  <span class="n">v7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">do</span>
  <span class="p">{</span>
    <span class="o">++</span><span class="n">v8</span><span class="p">;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">array_3014</span><span class="p">[(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">result</span><span class="p">];</span>
    <span class="n">v7</span> <span class="o">+=</span> <span class="n">result</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">result</span> <span class="o">!=</span> <span class="mi">15</span> <span class="p">);</span>
  <span class="n">v10</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">!=</span> <span class="mi">12</span> <span class="o">||</span> <span class="n">v7</span> <span class="o">!=</span> <span class="n">v9</span> <span class="p">)</span>
<span class="nl">LABEL_11</span><span class="p">:</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="s">&quot;%d %d&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>有点长，有点复杂，看看汇编分析一下：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.text:</span><span class="err">0000000000401002</span> <span class="c">; =============== S U B R O U T I N E =======================================</span>
<span class="nl">.text:</span><span class="err">0000000000401002</span>
<span class="nl">.text:</span><span class="err">0000000000401002</span>
<span class="nl">.text:</span><span class="err">0000000000401002</span> <span class="nf">public</span> <span class="no">phase_5</span>
<span class="nl">.text:</span><span class="err">0000000000401002</span> <span class="nf">phase_5</span> <span class="no">proc</span> <span class="no">near</span>                       <span class="c">; CODE XREF: main+100↑p</span>
<span class="nl">.text:</span><span class="err">0000000000401002</span>
<span class="nl">.text:</span><span class="err">0000000000401002</span> <span class="nf">var_10</span><span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">10</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000401002</span> <span class="nf">var_C</span><span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
<span class="nl">.text:</span><span class="err">0000000000401002</span>
<span class="nl">.text:</span><span class="err">0000000000401002</span> <span class="c">; __unwind {</span>
<span class="nl">.text:</span><span class="err">0000000000401002</span> <span class="nf">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">0000000000401006</span> <span class="nf">lea</span>     <span class="no">rcx</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_10</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">000000000040100</span><span class="nf">B</span> <span class="no">lea</span>     <span class="no">rdx</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000401010</span> <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">offset</span> <span class="no">aDD</span>                 <span class="c">; &quot;%d %d&quot;</span>
<span class="nl">.text:</span><span class="err">0000000000401015</span> <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">000000000040101</span><span class="nf">A</span> <span class="no">call</span>    <span class="no">___isoc99_sscanf</span>
<span class="nl">.text:</span><span class="err">000000000040101</span><span class="nf">F</span> <span class="no">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">1</span>
<span class="nl">.text:</span><span class="err">0000000000401022</span> <span class="nf">jg</span>      <span class="no">short</span> <span class="no">loc_401029</span>
<span class="nl">.text:</span><span class="err">0000000000401024</span> <span class="nf">call</span>    <span class="no">explode_bomb</span>
<span class="nl">.text:</span><span class="err">0000000000401029</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000401029</span>
<span class="nl">.text:</span><span class="err">0000000000401029</span> <span class="nl">loc_401029:</span>                             <span class="c">; CODE XREF: phase_5+20↑j</span>
<span class="nl">.text:</span><span class="err">0000000000401029</span> <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">000000000040102</span><span class="nf">D</span> <span class="no">and</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">Fh</span>
<span class="nl">.text:</span><span class="err">0000000000401030</span> <span class="nf">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_C</span><span class="p">],</span> <span class="no">eax</span>
<span class="nl">.text:</span><span class="err">0000000000401034</span> <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">Fh</span>
<span class="nl">.text:</span><span class="err">0000000000401037</span> <span class="nf">jz</span>      <span class="no">short</span> <span class="no">loc_401065</span>
<span class="nl">.text:</span><span class="err">0000000000401039</span> <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">000000000040103</span><span class="nf">E</span> <span class="no">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">0000000000401043</span>
<span class="nl">.text:</span><span class="err">0000000000401043</span> <span class="nl">loc_401043:</span>                             <span class="c">; CODE XREF: phase_5+52↓j</span>
<span class="nl">.text:</span><span class="err">0000000000401043</span> <span class="nf">add</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">1</span>
<span class="nl">.text:</span><span class="err">0000000000401046</span> <span class="nf">cdqe</span>
<span class="nl">.text:</span><span class="err">0000000000401048</span> <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ds</span><span class="p">:</span><span class="no">array_3014</span><span class="p">[</span><span class="no">rax</span><span class="p">*</span><span class="mi">4</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">000000000040104</span><span class="nf">F</span> <span class="no">add</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">eax</span>
<span class="nl">.text:</span><span class="err">0000000000401051</span> <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">Fh</span>
<span class="nl">.text:</span><span class="err">0000000000401054</span> <span class="nf">jnz</span>     <span class="no">short</span> <span class="no">loc_401043</span>
<span class="nl">.text:</span><span class="err">0000000000401056</span> <span class="nf">mov</span>     <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_C</span><span class="p">],</span> <span class="no">eax</span>
<span class="nl">.text:</span><span class="err">000000000040105</span><span class="nf">A</span> <span class="no">cmp</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">0</span><span class="no">Ch</span>
<span class="nl">.text:</span><span class="err">000000000040105</span><span class="nf">D</span> <span class="no">jnz</span>     <span class="no">short</span> <span class="no">loc_401065</span>
<span class="nl">.text:</span><span class="err">000000000040105</span><span class="nf">F</span> <span class="no">cmp</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">var_10</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000401063</span> <span class="nf">jz</span>      <span class="no">short</span> <span class="no">loc_40106A</span>
<span class="nl">.text:</span><span class="err">0000000000401065</span>
<span class="nl">.text:</span><span class="err">0000000000401065</span> <span class="nl">loc_401065:</span>                             <span class="c">; CODE XREF: phase_5+35↑j</span>
<span class="nl">.text:</span><span class="err">0000000000401065</span>                                         <span class="c">; phase_5+5B↑j</span>
<span class="nl">.text:</span><span class="err">0000000000401065</span> <span class="nf">call</span>    <span class="no">explode_bomb</span>
<span class="nl">.text:</span><span class="err">000000000040106</span><span class="nf">A</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">000000000040106</span><span class="nf">A</span>
<span class="nl">.text:</span><span class="err">000000000040106</span><span class="nf">A</span> <span class="no">loc_40106A</span><span class="p">:</span>                             <span class="c">; CODE XREF: phase_5+61↑j</span>
<span class="nl">.text:</span><span class="err">000000000040106</span><span class="nf">A</span> <span class="no">add</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
<span class="nl">.text:</span><span class="err">000000000040106</span><span class="nf">E</span> <span class="no">retn</span>
<span class="nl">.text:</span><span class="err">000000000040106</span><span class="nf">E</span> <span class="c">; } // starts at 401002</span>
<span class="nl">.text:</span><span class="err">000000000040106</span><span class="nf">E</span> <span class="no">phase_5</span> <span class="no">endp</span>
<span class="nl">.text:</span><span class="err">000000000040106</span><span class="nf">E</span>
</pre></div>
</td></tr></table>

<p>还有一个数组：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BA0</span> <span class="c">; int array_3014[16]</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BA0</span> <span class="no">array_3014</span> <span class="no">dd</span> <span class="mi">0</span><span class="no">Ah</span>                       <span class="c">; DATA XREF: phase_5+46↑r</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BA4</span> <span class="no">db</span>    <span class="mi">2</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BA5</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BA6</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BA7</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BA8</span> <span class="no">db</span>  <span class="mi">0</span><span class="no">Eh</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BA9</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BAA</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BAB</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BAC</span> <span class="no">db</span>    <span class="mi">7</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BAD</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BAE</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BAF</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BB0</span> <span class="no">db</span>    <span class="mi">8</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BB1</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BB2</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BB3</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BB4</span> <span class="no">db</span>  <span class="mi">0</span><span class="no">Ch</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BB5</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BB6</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BB7</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BB8</span> <span class="no">db</span>  <span class="mi">0</span><span class="no">Fh</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BB9</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BBA</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BBB</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BBC</span> <span class="no">db</span>  <span class="mi">0</span><span class="no">Bh</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BBD</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BBE</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BBF</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BC0</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BC1</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BC2</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BC3</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BC4</span> <span class="no">db</span>    <span class="mi">4</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BC5</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BC6</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BC7</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BC8</span> <span class="no">db</span>    <span class="mi">1</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BC9</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BCA</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BCB</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BCC</span> <span class="no">db</span>  <span class="mi">0</span><span class="no">Dh</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BCD</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BCE</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BCF</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BD0</span> <span class="no">db</span>    <span class="mi">3</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BD1</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BD2</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BD3</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BD4</span> <span class="no">db</span>    <span class="mi">9</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BD5</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BD6</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BD7</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BD8</span> <span class="no">db</span>    <span class="mi">6</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BD9</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BDA</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BDB</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BDC</span> <span class="no">db</span>    <span class="mi">5</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BDD</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BDE</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.rodata:</span><span class="err">0000000000401</span><span class="nf">BDF</span> <span class="no">db</span>    <span class="mi">0</span>
</pre></div>
</td></tr></table>

<p>尝试着还原一下：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="n">array</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xA</span><span class="p">,</span> <span class="mh">0x2</span><span class="p">,</span> <span class="mh">0xE</span><span class="p">,</span> <span class="mh">0x7</span><span class="p">,</span> 
               <span class="mh">0x8</span><span class="p">,</span> <span class="mh">0xC</span><span class="p">,</span> <span class="mh">0xF</span><span class="p">,</span> <span class="mh">0xB</span><span class="p">,</span> 
               <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0xD</span><span class="p">,</span> 
               <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0x6</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="p">};</span>

<span class="kt">void</span> <span class="nf">phase_5</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">number1</span><span class="p">,</span> <span class="n">number2</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d %d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">explode_bomb</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="n">number1</span> <span class="o">=</span> <span class="n">number1</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">number1</span> <span class="o">==</span> <span class="mh">0xF</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">explode_bomb</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">do</span> <span class="p">{</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">number1</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">number1</span><span class="p">];</span>
        <span class="n">sum</span> <span class="o">+=</span> <span class="n">number1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">number1</span> <span class="o">!=</span> <span class="mh">0xF</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mh">0xC</span> <span class="o">&amp;&amp;</span> <span class="n">sum</span> <span class="o">!=</span> <span class="n">number2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">explode_bomb</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>然后就发现自己逆的跟IDA的好像差不多...现在看起来已经很明确了，题目预置了一个16个整数的数组，要求输入两个整数。</p>
<p>其中，会先取第一个整数的二进制的后4位，也就是被截断后最大值是15，这个数值会被当作数组下标去查找数组中存储的值，随后累加查找到的值。并且，会用查找到的值继续当作数组下标去找到新的值，如此循环，直到取到<code>0xF</code>时停止。</p>
<p>注意到，停止的时候要求查找了12次，并且每次查找到的值的累加和应当与输入的第二个数相等。</p>
<p>所以我们可以从数组的第6个（从0开始），也就是<code>0xF</code>开始，逆向查找回去，于是可以得到正确的顺序应该是：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>array[7] ==&gt; 0xB ==&gt; 11
array[11] ==&gt; 0xD ==&gt; 13
array[13] ==&gt; 0x9 ==&gt; 9

array[9] ==&gt; 0x4 ==&gt; 4
array[4] ==&gt; 0x8 ==&gt; 8
array[8] ==&gt; 0x0 ==&gt; 0

array[0] ==&gt; 0xA ==&gt; 10
array[10] ==&gt; 0x1 ==&gt; 1
array[1] ==&gt; 0x2 ==&gt; 2

array[2] ==&gt; 0xE ==&gt; 14
array[14] ==&gt; 0x6 ==&gt; 6
array[6] ==&gt; 0xF ==&gt; 15
</pre></div>
</td></tr></table>

<p>也就是说，第一个数字应当是<code>7</code>，并且，累加和应当是<code>93</code>（我偷偷加好了）。所以第五部分的flag是：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>7 93
</pre></div>
</td></tr></table>

<h2 id="phase_6">phase_6</h2>
<blockquote>
<p>Congratulations! You've (mostly) defused the bomb!</p>
<p>Hit Control-C to escape phase 6 (for free!), but if you want to</p>
<p>try phase 6 for extra credit, you can continue.  Just beware!</p>
</blockquote>
<p>看起来题目说第六关是附加题？还是F5来看看：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">_DWORD</span> <span class="o">*</span><span class="kr">__fastcall</span> <span class="nf">phase_6</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">a1</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">_DWORD</span> <span class="o">*</span><span class="n">result</span><span class="p">;</span> <span class="c1">// rax</span>

  <span class="n">node0</span> <span class="o">=</span> <span class="n">strtol</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
  <span class="n">result</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">**</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">fun6</span><span class="p">(</span><span class="o">&amp;</span><span class="n">node0</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">result</span> <span class="o">!=</span> <span class="n">node0</span> <span class="p">)</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">node0</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>真令人害怕，好像是链表？</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">D9</span> <span class="c">; =============== S U B R O U T I N E =======================================</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">D9</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">D9</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">D9</span> <span class="no">public</span> <span class="no">phase_6</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">D9</span> <span class="no">phase_6</span> <span class="no">proc</span> <span class="no">near</span>                       <span class="c">; CODE XREF: main+130↑p</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">D9</span> <span class="c">; __unwind {</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">D9</span> <span class="no">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">8</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">DD</span> <span class="no">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">0</span><span class="no">Ah</span>                        <span class="c">; base</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">E2</span> <span class="no">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="mi">0</span>                          <span class="c">; endptr</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">E7</span> <span class="no">call</span>    <span class="no">_strtol</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">EC</span> <span class="no">mov</span>     <span class="no">cs</span><span class="p">:</span><span class="no">node0</span><span class="p">,</span> <span class="no">eax</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">F2</span> <span class="no">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">offset</span> <span class="no">node0</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">F7</span> <span class="no">call</span>    <span class="no">fun6</span>
<span class="nl">.text:</span><span class="err">00000000004010</span><span class="nf">FC</span> <span class="no">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="p">[</span><span class="no">rax</span><span class="err">+</span><span class="mi">8</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000401100</span> <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="p">[</span><span class="no">rax</span><span class="err">+</span><span class="mi">8</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000401104</span> <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="p">[</span><span class="no">rax</span><span class="err">+</span><span class="mi">8</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">0000000000401108</span> <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">cs</span><span class="p">:</span><span class="no">node0</span>
<span class="nl">.text:</span><span class="err">000000000040110</span><span class="nf">E</span> <span class="no">cmp</span>     <span class="p">[</span><span class="no">rax</span><span class="p">],</span> <span class="no">edx</span>
<span class="nl">.text:</span><span class="err">0000000000401110</span> <span class="nf">jz</span>      <span class="no">short</span> <span class="no">loc_401117</span>
<span class="nl">.text:</span><span class="err">0000000000401112</span> <span class="nf">call</span>    <span class="no">explode_bomb</span>
<span class="nl">.text:</span><span class="err">0000000000401117</span> <span class="c">; ---------------------------------------------------------------------------</span>
<span class="nl">.text:</span><span class="err">0000000000401117</span>
<span class="nl">.text:</span><span class="err">0000000000401117</span> <span class="nl">loc_401117:</span>                             <span class="c">; CODE XREF: phase_6+37↑j</span>
<span class="nl">.text:</span><span class="err">0000000000401117</span> <span class="nf">add</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">8</span>
<span class="nl">.text:</span><span class="err">000000000040111</span><span class="nf">B</span> <span class="no">retn</span>
<span class="nl">.text:</span><span class="err">000000000040111</span><span class="nf">B</span> <span class="c">; } // starts at 4010D9</span>
<span class="nl">.text:</span><span class="err">000000000040111</span><span class="nf">B</span> <span class="no">phase_6</span> <span class="no">endp</span>
<span class="nl">.text:</span><span class="err">000000000040111</span><span class="nf">B</span>
</pre></div>
</td></tr></table>

<p>还有各个节点：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.data:</span><span class="err">0000000000602780</span> <span class="nf">public</span> <span class="no">node0</span>
<span class="nl">.data:</span><span class="err">0000000000602780</span> <span class="nf">node0</span> <span class="no">dd</span> <span class="mi">0</span>                              <span class="c">; DATA XREF: phase_6+13↑w</span>
<span class="nl">.data:</span><span class="err">0000000000602780</span>                                         <span class="c">; phase_6+19↑o ...</span>
<span class="nl">.data:</span><span class="err">0000000000602784</span> <span class="nf">align</span> <span class="mi">8</span>
<span class="nl">.data:</span><span class="err">0000000000602788</span> <span class="nf">dq</span> <span class="no">offset</span> <span class="no">node1</span>
<span class="nl">.data:</span><span class="err">0000000000602790</span> <span class="nf">public</span> <span class="no">node1</span>
<span class="nl">.data:</span><span class="err">0000000000602790</span> <span class="nf">node1</span> <span class="no">db</span>  <span class="mi">76</span><span class="no">h</span> <span class="c">; v                       ; DATA XREF: .data:0000000000602788↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602791</span> <span class="nf">db</span>    <span class="mi">1</span>
<span class="nl">.data:</span><span class="err">0000000000602792</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602793</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602794</span> <span class="nf">db</span>    <span class="mi">1</span>
<span class="nl">.data:</span><span class="err">0000000000602795</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602796</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602797</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602798</span> <span class="nf">db</span> <span class="mi">0</span><span class="no">A0h</span>
<span class="nl">.data:</span><span class="err">0000000000602799</span> <span class="nf">db</span>  <span class="mi">27</span><span class="no">h</span> <span class="c">; &#39;</span>
<span class="nl">.data:</span><span class="err">000000000060279</span><span class="nf">A</span> <span class="no">db</span>  <span class="mi">60</span><span class="no">h</span> <span class="c">; `</span>
<span class="nl">.data:</span><span class="err">000000000060279</span><span class="nf">B</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060279</span><span class="nf">C</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060279</span><span class="nf">D</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060279</span><span class="nf">E</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060279</span><span class="nf">F</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A0</span> <span class="no">public</span> <span class="no">node2</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A0</span> <span class="no">node2</span> <span class="no">db</span>  <span class="mi">3</span><span class="no">Ah</span> <span class="c">; :</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A1</span> <span class="no">db</span>    <span class="mi">3</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A2</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A3</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A4</span> <span class="no">db</span>    <span class="mi">2</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A5</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A6</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A7</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A8</span> <span class="no">db</span> <span class="mi">0</span><span class="no">B0h</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A9</span> <span class="no">db</span>  <span class="mi">27</span><span class="no">h</span> <span class="c">; &#39;</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">AA</span> <span class="no">db</span>  <span class="mi">60</span><span class="no">h</span> <span class="c">; `</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">AB</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">AC</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">AD</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">AE</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">AF</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B0</span> <span class="no">public</span> <span class="no">node3</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B0</span> <span class="no">node3</span> <span class="no">db</span>  <span class="mi">72</span><span class="no">h</span> <span class="c">; r</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B1</span> <span class="no">db</span>    <span class="mi">1</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B2</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B3</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B4</span> <span class="no">db</span>    <span class="mi">3</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B5</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B6</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B7</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B8</span> <span class="no">db</span> <span class="mi">0</span><span class="no">C0h</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B9</span> <span class="no">db</span>  <span class="mi">27</span><span class="no">h</span> <span class="c">; &#39;</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">BA</span> <span class="no">db</span>  <span class="mi">60</span><span class="no">h</span> <span class="c">; `</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">BB</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">BC</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">BD</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">BE</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">BF</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C0</span> <span class="no">public</span> <span class="no">node4</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C0</span> <span class="no">node4</span> <span class="no">db</span>  <span class="mi">0</span><span class="no">Eh</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C1</span> <span class="no">db</span>    <span class="mi">3</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C2</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C3</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C4</span> <span class="no">db</span>    <span class="mi">4</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C5</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C6</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C7</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C8</span> <span class="no">db</span> <span class="mi">0</span><span class="no">D0h</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C9</span> <span class="no">db</span>  <span class="mi">27</span><span class="no">h</span> <span class="c">; &#39;</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">CA</span> <span class="no">db</span>  <span class="mi">60</span><span class="no">h</span> <span class="c">; `</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">CB</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">CC</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">CD</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">CE</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">CF</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D0</span> <span class="no">public</span> <span class="no">node5</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D0</span> <span class="no">node5</span> <span class="no">db</span> <span class="mi">0</span><span class="no">E8h</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D1</span> <span class="no">db</span>    <span class="mi">1</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D2</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D3</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D4</span> <span class="no">db</span>    <span class="mi">5</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D5</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D6</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D7</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D8</span> <span class="no">db</span> <span class="mi">0</span><span class="no">E0h</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D9</span> <span class="no">db</span>  <span class="mi">27</span><span class="no">h</span> <span class="c">; &#39;</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">DA</span> <span class="no">db</span>  <span class="mi">60</span><span class="no">h</span> <span class="c">; `</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">DB</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">DC</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">DD</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">DE</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">DF</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E0</span> <span class="no">public</span> <span class="no">node6</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E0</span> <span class="no">node6</span> <span class="no">db</span> <span class="mi">0</span><span class="no">A1h</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E1</span> <span class="no">db</span>    <span class="mi">2</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E2</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E3</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E4</span> <span class="no">db</span>    <span class="mi">6</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E5</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E6</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E7</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E8</span> <span class="no">db</span> <span class="mi">0</span><span class="no">F0h</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E9</span> <span class="no">db</span>  <span class="mi">27</span><span class="no">h</span> <span class="c">; &#39;</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">EA</span> <span class="no">db</span>  <span class="mi">60</span><span class="no">h</span> <span class="c">; `</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">EB</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">EC</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">ED</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">EE</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">EF</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F0</span> <span class="no">public</span> <span class="no">node7</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F0</span> <span class="no">node7</span> <span class="no">db</span>  <span class="mi">1</span><span class="no">Eh</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F1</span> <span class="no">db</span>    <span class="mi">1</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F2</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F3</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F4</span> <span class="no">db</span>    <span class="mi">7</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F5</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F6</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F7</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F8</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F9</span> <span class="no">db</span>  <span class="mi">28</span><span class="no">h</span> <span class="c">; (</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">FA</span> <span class="no">db</span>  <span class="mi">60</span><span class="no">h</span> <span class="c">; `</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">FB</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">FC</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">FD</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">FE</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">FF</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602800</span> <span class="nf">public</span> <span class="no">node8</span>
<span class="nl">.data:</span><span class="err">0000000000602800</span> <span class="nf">node8</span> <span class="no">db</span>  <span class="mi">58</span><span class="no">h</span> <span class="c">; X</span>
<span class="nl">.data:</span><span class="err">0000000000602801</span> <span class="nf">db</span>    <span class="mi">2</span>
<span class="nl">.data:</span><span class="err">0000000000602802</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602803</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602804</span> <span class="nf">db</span>    <span class="mi">8</span>
<span class="nl">.data:</span><span class="err">0000000000602805</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602806</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602807</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602808</span> <span class="nf">db</span>  <span class="mi">10</span><span class="no">h</span>
<span class="nl">.data:</span><span class="err">0000000000602809</span> <span class="nf">db</span>  <span class="mi">28</span><span class="no">h</span> <span class="c">; (</span>
<span class="nl">.data:</span><span class="err">000000000060280</span><span class="nf">A</span> <span class="no">db</span>  <span class="mi">60</span><span class="no">h</span> <span class="c">; `</span>
<span class="nl">.data:</span><span class="err">000000000060280</span><span class="nf">B</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060280</span><span class="nf">C</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060280</span><span class="nf">D</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060280</span><span class="nf">E</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060280</span><span class="nf">F</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602810</span> <span class="nf">public</span> <span class="no">node9</span>
<span class="nl">.data:</span><span class="err">0000000000602810</span> <span class="nf">node9</span> <span class="no">db</span>  <span class="mi">11</span><span class="no">h</span>
<span class="nl">.data:</span><span class="err">0000000000602811</span> <span class="nf">db</span>    <span class="mi">2</span>
<span class="nl">.data:</span><span class="err">0000000000602812</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602813</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602814</span> <span class="nf">db</span>    <span class="mi">9</span>
<span class="nl">.data:</span><span class="err">0000000000602815</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602816</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602817</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602818</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">0000000000602819</span> <span class="nf">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060281</span><span class="nf">A</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060281</span><span class="nf">B</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060281</span><span class="nf">C</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060281</span><span class="nf">D</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060281</span><span class="nf">E</span> <span class="no">db</span>    <span class="mi">0</span>
<span class="nl">.data:</span><span class="err">000000000060281</span><span class="nf">F</span> <span class="no">db</span>    <span class="mi">0</span>
</pre></div>
</td></tr></table>

<p>注意到这段数据区的每个node的后8个字节似乎正好是下一个node的地址，按D转换成像这样：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.data:</span><span class="err">0000000000602780</span>                 <span class="nf">public</span> <span class="no">node0</span>
<span class="nl">.data:</span><span class="err">0000000000602780</span> <span class="nf">node0</span>           <span class="no">dd</span> <span class="mi">0</span>                    <span class="c">; DATA XREF: phase_6+13↑w</span>
<span class="nl">.data:</span><span class="err">0000000000602780</span>                                         <span class="c">; phase_6+19↑o ...</span>
<span class="nl">.data:</span><span class="err">0000000000602784</span>                 <span class="nf">align</span> <span class="mi">8</span>
<span class="nl">.data:</span><span class="err">0000000000602788</span>                 <span class="nf">dq</span> <span class="no">offset</span> <span class="no">node1</span>
<span class="nl">.data:</span><span class="err">0000000000602790</span>                 <span class="nf">public</span> <span class="no">node1</span>
<span class="nl">.data:</span><span class="err">0000000000602790</span> <span class="nf">node1</span>           <span class="no">dd</span> <span class="mi">176</span><span class="no">h</span>                 <span class="c">; DATA XREF: .data:0000000000602788↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602794</span>                 <span class="nf">dd</span> <span class="mi">1</span>
<span class="nl">.data:</span><span class="err">0000000000602798</span>                 <span class="nf">dq</span> <span class="no">offset</span> <span class="no">node2</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A0</span>                 <span class="no">public</span> <span class="no">node2</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A0</span> <span class="no">node2</span>           <span class="no">dd</span> <span class="mi">33</span><span class="no">Ah</span>                 <span class="c">; DATA XREF: .data:0000000000602798↑o</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A4</span>                 <span class="no">dd</span> <span class="mi">2</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A8</span>                 <span class="no">dq</span> <span class="no">offset</span> <span class="no">node3</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B0</span>                 <span class="no">public</span> <span class="no">node3</span>
</pre></div>
</td></tr></table>

<p>基本上可以看出来，一个节点里有一个数据和序号，还有一个指向下一个节点的指针。于是到<code>Structures</code>里添加一个结构体<code>Node</code>，就像这个样子：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">00000000</span> <span class="nf">Node</span>            <span class="no">struc</span> <span class="c">; (sizeof=0x10, mappedto_13)</span>
<span class="err">00000000</span>                                         <span class="c">; XREF: .data:node1/r</span>
<span class="err">00000000</span>                                         <span class="c">; .data:node2/r</span>
<span class="err">00000000</span> <span class="nf">data</span>            <span class="no">dd</span> <span class="err">?</span>
<span class="err">00000004</span> <span class="nf">index</span>           <span class="no">dd</span> <span class="err">?</span>
<span class="err">00000008</span> <span class="nf">next</span>            <span class="no">dq</span> <span class="err">?</span>                    <span class="c">; offset</span>
<span class="err">00000010</span> <span class="nf">Node</span>            <span class="no">ends</span>
<span class="err">00000010</span>
</pre></div>
</td></tr></table>

<p>回到汇编代码段，对着每个node按Y，指定它的类型，就会变成这样：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.data:</span><span class="err">0000000000602780</span>                 <span class="nf">public</span> <span class="no">node0</span>
<span class="nl">.data:</span><span class="err">0000000000602780</span> <span class="c">; Node node0</span>
<span class="nl">.data:</span><span class="err">0000000000602780</span> <span class="nf">node0</span>           <span class="no">Node</span> <span class="err">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="no">offset</span> <span class="no">node1</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">0000000000602780</span>                                         <span class="c">; DATA XREF: phase_6+13↑w</span>
<span class="nl">.data:</span><span class="err">0000000000602780</span>                                         <span class="c">; phase_6+19↑o ...</span>
<span class="nl">.data:</span><span class="err">0000000000602790</span>                 <span class="nf">public</span> <span class="no">node1</span>
<span class="nl">.data:</span><span class="err">0000000000602790</span> <span class="c">; Node node1</span>
<span class="nl">.data:</span><span class="err">0000000000602790</span> <span class="nf">node1</span>           <span class="no">Node</span> <span class="err">&lt;</span><span class="mi">176</span><span class="no">h</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">node2.data</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">0000000000602790</span>                                         <span class="c">; DATA XREF: .data:node0↑o</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A0</span>                 <span class="no">public</span> <span class="no">node2</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A0</span> <span class="c">; Node node2</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A0</span> <span class="no">node2</span>           <span class="no">Node</span> <span class="err">&lt;</span><span class="mi">33</span><span class="no">Ah</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="no">offset</span> <span class="no">node3</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">A0</span>                                         <span class="c">; DATA XREF: .data:node1↑o</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B0</span>                 <span class="no">public</span> <span class="no">node3</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B0</span> <span class="c">; Node node3</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B0</span> <span class="no">node3</span>           <span class="no">Node</span> <span class="err">&lt;</span><span class="mi">172</span><span class="no">h</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="no">offset</span> <span class="no">node4</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">B0</span>                                         <span class="c">; DATA XREF: .data:node2↑o</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C0</span>                 <span class="no">public</span> <span class="no">node4</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C0</span> <span class="c">; Node node4</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C0</span> <span class="no">node4</span>           <span class="no">Node</span> <span class="err">&lt;</span><span class="mi">30</span><span class="no">Eh</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="no">offset</span> <span class="no">node5</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">C0</span>                                         <span class="c">; DATA XREF: .data:node3↑o</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D0</span>                 <span class="no">public</span> <span class="no">node5</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D0</span> <span class="c">; Node node5</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D0</span> <span class="no">node5</span>           <span class="no">Node</span> <span class="err">&lt;</span><span class="mi">1</span><span class="no">E8h</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="no">offset</span> <span class="no">node6</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">D0</span>                                         <span class="c">; DATA XREF: .data:node4↑o</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E0</span>                 <span class="no">public</span> <span class="no">node6</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E0</span> <span class="c">; Node node6</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E0</span> <span class="no">node6</span>           <span class="no">Node</span> <span class="err">&lt;</span><span class="mi">2</span><span class="no">A1h</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="no">offset</span> <span class="no">node7</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">E0</span>                                         <span class="c">; DATA XREF: .data:node5↑o</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F0</span>                 <span class="no">public</span> <span class="no">node7</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F0</span> <span class="c">; Node node7</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F0</span> <span class="no">node7</span>           <span class="no">Node</span> <span class="err">&lt;</span><span class="mi">11</span><span class="no">Eh</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="no">offset</span> <span class="no">node8</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">00000000006027</span><span class="nf">F0</span>                                         <span class="c">; DATA XREF: .data:node6↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602800</span>                 <span class="nf">public</span> <span class="no">node8</span>
<span class="nl">.data:</span><span class="err">0000000000602800</span> <span class="c">; Node node8</span>
<span class="nl">.data:</span><span class="err">0000000000602800</span> <span class="nf">node8</span>           <span class="no">Node</span> <span class="err">&lt;</span><span class="mi">258</span><span class="no">h</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="no">offset</span> <span class="no">node9</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">0000000000602800</span>                                         <span class="c">; DATA XREF: .data:node7↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602810</span>                 <span class="nf">public</span> <span class="no">node9</span>
<span class="nl">.data:</span><span class="err">0000000000602810</span> <span class="c">; Node node9</span>
<span class="nl">.data:</span><span class="err">0000000000602810</span> <span class="nf">node9</span>           <span class="no">Node</span> <span class="err">&lt;</span><span class="mi">211</span><span class="no">h</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>       <span class="c">; DATA XREF: .data:node8↑o</span>
</pre></div>
</td></tr></table>

<p>好了，每个数据都相当清楚了。来看看<code>phase_6()</code>吧，由于我们已经知道了参数是一个<code>Node *</code>，所以还是对着参数按Y把类型改成<code>Node *</code>。这个时候只要再按一下F5（似乎只是为了刷新一下），就会发现已经...：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Node</span> <span class="o">*</span><span class="kr">__fastcall</span> <span class="nf">phase_6</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">a1</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Node</span> <span class="o">*</span><span class="n">result</span><span class="p">;</span> <span class="c1">// rax</span>

  <span class="n">node0</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">strtol</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">fun6</span><span class="p">(</span><span class="o">&amp;</span><span class="n">node0</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">next</span><span class="o">-&gt;</span><span class="n">next</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">result</span><span class="o">-&gt;</span><span class="n">data</span> <span class="o">!=</span> <span class="n">node0</span><span class="p">.</span><span class="n">data</span> <span class="p">)</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">node0</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>还有这个：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Node</span> <span class="o">*</span><span class="kr">__fastcall</span> <span class="nf">fun6</span><span class="p">(</span><span class="n">Node</span> <span class="o">*</span><span class="n">a1</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Node</span> <span class="o">*</span><span class="n">v1</span><span class="p">;</span> <span class="c1">// r8</span>
  <span class="n">Node</span> <span class="o">*</span><span class="n">result</span><span class="p">;</span> <span class="c1">// rax</span>
  <span class="n">Node</span> <span class="o">*</span><span class="n">v3</span><span class="p">;</span> <span class="c1">// rcx</span>
  <span class="n">Node</span> <span class="o">*</span><span class="n">v4</span><span class="p">;</span> <span class="c1">// rdx</span>
  <span class="n">Node</span> <span class="o">*</span><span class="n">v5</span><span class="p">;</span> <span class="c1">// rcx</span>

  <span class="n">v1</span> <span class="o">=</span> <span class="n">a1</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
  <span class="n">a1</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">a1</span><span class="p">;</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="n">a1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v1</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">a1</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v4</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">&amp;&amp;</span> <span class="n">v3</span><span class="o">-&gt;</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">v1</span><span class="o">-&gt;</span><span class="n">data</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="n">v4</span> <span class="o">=</span> <span class="n">v3</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v4</span> <span class="p">)</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span><span class="o">-&gt;</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">v1</span><span class="o">-&gt;</span><span class="n">data</span> <span class="p">)</span>
        <span class="p">{</span>
          <span class="n">a1</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>
          <span class="k">goto</span> <span class="n">LABEL_8</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">v3</span> <span class="o">=</span> <span class="n">v3</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">a1</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>
    <span class="p">}</span>
<span class="nl">LABEL_8</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">a1</span> <span class="o">==</span> <span class="n">v4</span> <span class="p">)</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
    <span class="k">else</span>
      <span class="n">a1</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
    <span class="n">v5</span> <span class="o">=</span> <span class="n">v1</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
    <span class="n">v1</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">v4</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v5</span> <span class="p">)</span>
      <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">v5</span><span class="p">;</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>这个时候我已经累了，不想再写了...经过尝试输入链表中的数据动态调试可以发现，函数对链表进行了排序，应该输入第四大的数据<code>258h</code>就可以了。所以：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>600
</pre></div>
</td></tr></table>

<h2 id="secret_phase">secret_phase</h2>
<p>其实在IDA左侧栏能看到一个隐藏关<code>secret_phase()</code>，双击它，然后按X查找引用。可以看到，在每关<code>phase_defused()</code>时都会检查是否触发隐藏关：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">void</span> <span class="no">__fastcall</span> <span class="no">phase_defused</span><span class="p">(</span><span class="no">__int64</span> <span class="no">a1</span><span class="p">,</span> <span class="no">__int64</span> <span class="no">a2</span><span class="p">,</span> <span class="no">__int64</span> <span class="no">a3</span><span class="p">,</span> <span class="no">__int64</span> <span class="no">a4</span><span class="p">,</span> <span class="no">__int64</span> <span class="no">a5</span><span class="p">,</span> <span class="no">__int64</span> <span class="no">a6</span><span class="p">)</span>
<span class="err">{</span>
  <span class="nf">char</span> <span class="no">v6</span><span class="c">; // [rsp+Ch] [rbp-5Ch]</span>
  <span class="nf">char</span> <span class="no">v7</span><span class="c">; // [rsp+10h] [rbp-58h]</span>

  <span class="nf">if</span> <span class="p">(</span> <span class="no">num_input_strings</span> <span class="err">==</span> <span class="mi">6</span> <span class="p">)</span>
  <span class="err">{</span>
    <span class="nf">if</span> <span class="p">(</span> <span class="p">(</span><span class="no">unsigned</span> <span class="no">int</span><span class="p">)</span><span class="no">__isoc99_sscanf</span><span class="p">(</span><span class="err">&amp;</span><span class="no">unk_603030</span><span class="p">,</span> <span class="err">&quot;</span><span class="nv">%d</span> <span class="nv">%s</span><span class="err">&quot;</span><span class="p">,</span> <span class="err">&amp;</span><span class="no">v6</span><span class="p">,</span> <span class="err">&amp;</span><span class="no">v7</span><span class="p">,</span> <span class="no">a5</span><span class="p">,</span> <span class="no">a6</span><span class="p">)</span> <span class="err">==</span> <span class="mi">2</span>
      <span class="err">&amp;&amp;</span> <span class="err">!(</span><span class="nf">unsigned</span> <span class="no">int</span><span class="p">)</span><span class="no">strings_not_equal</span><span class="p">(</span><span class="err">&amp;</span><span class="no">v7</span><span class="p">,</span> <span class="err">&quot;</span><span class="no">austinpowers</span><span class="err">&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="err">{</span>
      <span class="nf">puts</span><span class="p">(</span><span class="err">&quot;</span><span class="no">Curses</span><span class="p">,</span> <span class="no">you</span><span class="err">&#39;</span><span class="no">ve</span> <span class="no">found</span> <span class="no">the</span> <span class="no">secret</span> <span class="no">phase</span><span class="p">!</span><span class="err">&quot;</span><span class="p">)</span><span class="c">;</span>
      <span class="nf">puts</span><span class="p">(</span><span class="err">&quot;</span><span class="no">But</span> <span class="no">finding</span> <span class="no">it</span> <span class="no">and</span> <span class="no">solving</span> <span class="no">it</span> <span class="no">are</span> <span class="no">quite</span> <span class="no">different...</span><span class="err">&quot;</span><span class="p">)</span><span class="c">;</span>
      <span class="nf">secret_phase</span><span class="p">((</span><span class="no">__int64</span><span class="p">)</span><span class="err">&quot;</span><span class="no">But</span> <span class="no">finding</span> <span class="no">it</span> <span class="no">and</span> <span class="no">solving</span> <span class="no">it</span> <span class="no">are</span> <span class="no">quite</span> <span class="no">different...</span><span class="err">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="no">__int64</span><span class="p">)</span><span class="err">&quot;</span><span class="no">austinpowers</span><span class="err">&quot;</span><span class="p">)</span><span class="c">;</span>
    <span class="err">}</span>
    <span class="nf">puts</span><span class="p">(</span><span class="err">&quot;</span><span class="no">Congratulations</span><span class="p">!</span> <span class="no">You</span><span class="err">&#39;</span><span class="no">ve</span> <span class="no">defused</span> <span class="no">the</span> <span class="no">bomb</span><span class="p">!</span> <span class="no">Again</span><span class="p">!</span><span class="err">&quot;</span><span class="p">)</span><span class="c">;</span>
  <span class="err">}</span>
<span class="err">}</span>
</pre></div>
</td></tr></table>

<p>动态调试的时候能发现第四关时需要输入：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>9 austinpowers
</pre></div>
</td></tr></table>

<p>就可以触发隐藏关。隐藏关是个二叉树，先加入以下结构体：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">00000000</span> <span class="nf">BiTree</span>          <span class="no">struc</span> <span class="c">; (sizeof=0x20, mappedto_14)</span>
<span class="err">00000000</span>                                         <span class="c">; XREF: .data:n1/r</span>
<span class="err">00000000</span>                                         <span class="c">; .data:n21/r ...</span>
<span class="err">00000000</span> <span class="nf">data</span>            <span class="no">dq</span> <span class="err">?</span>
<span class="err">00000008</span> <span class="nf">lchild</span>          <span class="no">dq</span> <span class="err">?</span>                    <span class="c">; offset</span>
<span class="err">00000010</span> <span class="nf">rchild</span>          <span class="no">dq</span> <span class="err">?</span>                    <span class="c">; offset</span>
<span class="err">00000018</span> <span class="nf">unknown</span>         <span class="no">dq</span> <span class="err">?</span>
<span class="err">00000020</span> <span class="nf">BiTree</span>          <span class="no">ends</span>
<span class="err">00000020</span>
</pre></div>
</td></tr></table>

<p>还是F5：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">secret_phase</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">v1</span><span class="p">;</span> <span class="c1">// rdi</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// ebx</span>

  <span class="n">v1</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">read_line</span><span class="p">(</span><span class="n">a1</span><span class="p">);</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">strtol</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v2</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mh">0x3E8</span> <span class="p">)</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">fun7</span><span class="p">((</span><span class="n">BiTree</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">n1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span> <span class="p">)</span>
    <span class="n">explode_bomb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">n1</span><span class="p">,</span> <span class="n">v2</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Wow! You&#39;ve defused the secret stage!&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">phase_defused</span><span class="p">(</span><span class="s">&quot;Wow! You&#39;ve defused the secret stage!&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>还有：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">signed</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">fun7</span><span class="p">(</span><span class="n">BiTree</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">signed</span> <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax</span>

  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">a1</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mh">0xFFFFFFFFLL</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">SLODWORD</span><span class="p">(</span><span class="n">a1</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">a2</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">fun7</span><span class="p">(</span><span class="n">a1</span><span class="o">-&gt;</span><span class="n">lchild</span><span class="p">,</span> <span class="n">a2</span><span class="p">);</span>
  <span class="n">result</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">LODWORD</span><span class="p">(</span><span class="n">a1</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="n">a2</span> <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">fun7</span><span class="p">(</span><span class="n">a1</span><span class="o">-&gt;</span><span class="n">rchild</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>还有二叉树：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">A0</span>                 <span class="no">public</span> <span class="no">n1</span>
<span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">A0</span> <span class="c">; BiTree n1</span>
<span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">A0</span> <span class="no">n1</span>              <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">24</span><span class="no">h</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n21</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n22</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">A0</span>                                         <span class="c">; DATA XREF: secret_phase+2B↑o</span>
<span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">C0</span>                 <span class="no">public</span> <span class="no">n21</span>
<span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">C0</span> <span class="c">; BiTree n21</span>
<span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">C0</span> <span class="no">n21</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">8</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n31</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n32</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">C0</span>                                         <span class="c">; DATA XREF: .data:n1↑o</span>
<span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">E0</span>                 <span class="no">public</span> <span class="no">n22</span>
<span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">E0</span> <span class="c">; BiTree n22</span>
<span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">E0</span> <span class="no">n22</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">32</span><span class="no">h</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n33</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n34</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">00000000006025</span><span class="nf">E0</span>                                         <span class="c">; DATA XREF: .data:n1↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602600</span>                 <span class="nf">public</span> <span class="no">n32</span>
<span class="nl">.data:</span><span class="err">0000000000602600</span> <span class="c">; BiTree n32</span>
<span class="nl">.data:</span><span class="err">0000000000602600</span> <span class="nf">n32</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">16</span><span class="no">h</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n43</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n44</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">0000000000602600</span>                                         <span class="c">; DATA XREF: .data:n21↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602620</span>                 <span class="nf">public</span> <span class="no">n33</span>
<span class="nl">.data:</span><span class="err">0000000000602620</span> <span class="c">; BiTree n33</span>
<span class="nl">.data:</span><span class="err">0000000000602620</span> <span class="nf">n33</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">2</span><span class="no">Dh</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n45</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n46</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">0000000000602620</span>                                         <span class="c">; DATA XREF: .data:n22↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602640</span>                 <span class="nf">public</span> <span class="no">n31</span>
<span class="nl">.data:</span><span class="err">0000000000602640</span> <span class="c">; BiTree n31</span>
<span class="nl">.data:</span><span class="err">0000000000602640</span> <span class="nf">n31</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">6</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n41</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n42</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">0000000000602640</span>                                         <span class="c">; DATA XREF: .data:n21↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602660</span>                 <span class="nf">public</span> <span class="no">n34</span>
<span class="nl">.data:</span><span class="err">0000000000602660</span> <span class="c">; BiTree n34</span>
<span class="nl">.data:</span><span class="err">0000000000602660</span> <span class="nf">n34</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">6</span><span class="no">Bh</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n47</span><span class="p">,</span> <span class="no">offset</span> <span class="no">n48</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>
<span class="nl">.data:</span><span class="err">0000000000602660</span>                                         <span class="c">; DATA XREF: .data:n22↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602680</span>                 <span class="nf">public</span> <span class="no">n45</span>
<span class="nl">.data:</span><span class="err">0000000000602680</span> <span class="c">; BiTree n45</span>
<span class="nl">.data:</span><span class="err">0000000000602680</span> <span class="nf">n45</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">28</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>   <span class="c">; DATA XREF: .data:n33↑o</span>
<span class="nl">.data:</span><span class="err">00000000006026</span><span class="nf">A0</span>                 <span class="no">public</span> <span class="no">n41</span>
<span class="nl">.data:</span><span class="err">00000000006026</span><span class="nf">A0</span> <span class="c">; BiTree n41</span>
<span class="nl">.data:</span><span class="err">00000000006026</span><span class="nf">A0</span> <span class="no">n41</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>     <span class="c">; DATA XREF: .data:n31↑o</span>
<span class="nl">.data:</span><span class="err">00000000006026</span><span class="nf">C0</span>                 <span class="no">public</span> <span class="no">n47</span>
<span class="nl">.data:</span><span class="err">00000000006026</span><span class="nf">C0</span> <span class="c">; BiTree n47</span>
<span class="nl">.data:</span><span class="err">00000000006026</span><span class="nf">C0</span> <span class="no">n47</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">63</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>   <span class="c">; DATA XREF: .data:n34↑o</span>
<span class="nl">.data:</span><span class="err">00000000006026</span><span class="nf">E0</span>                 <span class="no">public</span> <span class="no">n44</span>
<span class="nl">.data:</span><span class="err">00000000006026</span><span class="nf">E0</span> <span class="c">; BiTree n44</span>
<span class="nl">.data:</span><span class="err">00000000006026</span><span class="nf">E0</span> <span class="no">n44</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">23</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>   <span class="c">; DATA XREF: .data:n32↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602700</span>                 <span class="nf">public</span> <span class="no">n42</span>
<span class="nl">.data:</span><span class="err">0000000000602700</span> <span class="c">; BiTree n42</span>
<span class="nl">.data:</span><span class="err">0000000000602700</span> <span class="nf">n42</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>     <span class="c">; DATA XREF: .data:n31↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602720</span>                 <span class="nf">public</span> <span class="no">n43</span>
<span class="nl">.data:</span><span class="err">0000000000602720</span> <span class="c">; BiTree n43</span>
<span class="nl">.data:</span><span class="err">0000000000602720</span> <span class="nf">n43</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">14</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>   <span class="c">; DATA XREF: .data:n32↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602740</span>                 <span class="nf">public</span> <span class="no">n46</span>
<span class="nl">.data:</span><span class="err">0000000000602740</span> <span class="c">; BiTree n46</span>
<span class="nl">.data:</span><span class="err">0000000000602740</span> <span class="nf">n46</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">2</span><span class="no">Fh</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>   <span class="c">; DATA XREF: .data:n33↑o</span>
<span class="nl">.data:</span><span class="err">0000000000602760</span>                 <span class="nf">public</span> <span class="no">n48</span>
<span class="nl">.data:</span><span class="err">0000000000602760</span> <span class="c">; BiTree n48</span>
<span class="nl">.data:</span><span class="err">0000000000602760</span> <span class="nf">n48</span>             <span class="no">BiTree</span> <span class="err">&lt;</span><span class="mi">3</span><span class="no">E9h</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="err">&gt;</span>  <span class="c">; DATA XREF: .data:n34↑o</span>
</pre></div>
</td></tr></table>

<p>是个二叉排序树的样子。</p>
<blockquote>
<p>用<a href="https://visualgo.net/zh/bst">VisuAlgo - 二叉搜索树，高度平衡树</a>画的图</p>
</blockquote>
<p><img alt="BOMB-LAB_2.png" src="../img/BOMB-LAB_2.png" /></p>
<p>看函数的递归调用可以知道：输入的数据比节点大则访问左孩子，小于则访问右孩子，相等会返回0。由于结果需要为<code>3</code>，结合上面递归调用的算法，所以应该是<code>2 × (2 × 0 + 1) + 1</code>，访问顺序应该是（输入的数据通过影响遍历的路径来影响结果）：</p>
<blockquote>
<p>24h 32h 6Bh</p>
</blockquote>
<p>也就是说，可以输入<code>6Bh</code>通过check：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>107
</pre></div>
</td></tr></table>

<p>应该就可以结束了！</p>
<h2 id="flag">flag</h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>Science isn&#39;t about why, it&#39;s about why not?
1 2 3 1 2 3
1 926
9 austinpowers
7 93
600
107
</pre></div>
</td></tr></table>

<p><img alt="BOMB-LAB_3.png" src="../img/BOMB-LAB_3.png" /></p>
<p>完结撒花...</p>
<blockquote>
<p>图片来源：<a href="https://www.weibo.com/u/3540182725">不觉晓晓-蜜桃猫</a></p>
</blockquote>
<p><img alt="MITAO.jpg" src="../img/MITAO.jpg" /></p>
<p>有问题可以评论区或是邮箱告诉我。感恩。</p>
                
                  
                
              
              
                



<h2 id="__comments">评论</h2>
<form id="gitalk-form" onsubmit="return false;">
    <div id="gitalk-container"></div>
</form>
<link rel="stylesheet" href="https://blog.52szu.tech/css/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://blog.52szu.tech/js/md5.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: '47cbdcb78708efcedf52',
        clientSecret: 'e22cda14ad8bb219e7f4f1619bc6fcf5b66e22ef',
        repo: 'comments',
        owner: 'szu17dmy',
        admin: ['szu17dmy'],
        id: md5(location.pathname), // Ensure uniqueness and length less than 50
        distractionFreeMode: false // Facebook-like distraction free mode
    })
    gitalk.render('gitalk-container')
</script>
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../datalab/" title="Data Lab" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                Data Lab
              </span>
            </div>
          </a>
        
        
          <a href="../../cn/vlan_lab/" title="VLAN Lab" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                VLAN Lab
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/szu17dmy" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.dc02f8ce.js"></script>
      
        
        
          
          <script src="../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../../assets/javascripts/lunr/lunr.ja.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
    
  </body>
</html>